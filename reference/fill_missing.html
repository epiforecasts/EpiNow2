<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fill missing data in a data set to prepare it for use within the package — fill_missing • EpiNow2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fill missing data in a data set to prepare it for use within the package — fill_missing"><meta name="description" content="
This function ensures that all days between the first and last date in the
data are present. It adds an accumulate column that indicates whether
modelled observations should be accumulated onto a later data point.
point. This is useful for modelling data that is reported less frequently
than daily, e.g. weekly incidence data, as well as other reporting
artifacts such as delayed weekedn reporting. The function can also be used
to fill in missing observations with zeros."><meta property="og:description" content="
This function ensures that all days between the first and last date in the
data are present. It adds an accumulate column that indicates whether
modelled observations should be accumulated onto a later data point.
point. This is useful for modelling data that is reported less frequently
than daily, e.g. weekly incidence data, as well as other reporting
artifacts such as delayed weekedn reporting. The function can also be used
to fill in missing observations with zeros."><meta property="og:image" content="https://epiforecasts.io/EpiNow2/reference/figures/unnamed-chunk-14-1.png"><meta property="og:image:alt" content="Example estimates produced by EpiNow2 of the reproduction number, cases by date of infection and cases by date of report"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@seabbs"><meta name="twitter:site" content="@epiforecasts"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiNow2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/EpiNow2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-model-definitions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Model definitions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-model-definitions"><li><a class="dropdown-item" href="../articles/estimate_infections.html">estimate_infections()</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_secondary.html">estimate_secondary()</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_truncation.html">estimate_truncation()</a></li>
    <li><a class="dropdown-item" href="../articles/gaussian_process_implementation_details.html">Gaussian Process implementation details</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-usage" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Usage</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-usage"><li><a class="dropdown-item" href="../articles/estimate_infections_workflow.html">Workflow for Rt estimation and forecasting</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_infections_options.html">Examples: estimate_infections()</a></li>
    <li><a class="dropdown-item" href="../articles/epinow.html">Using epinow() for running in production mode</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies"><li><a class="dropdown-item" href="../articles/case-studies.html">External case studies and use in the literature</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiforecasts/EpiNow2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fill missing data in a data set to prepare it for use within the package</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/EpiNow2/blob/main/R/preprocessing.R" class="external-link"><code>R/preprocessing.R</code></a></small>
      <div class="d-none name"><code>fill_missing.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
This function ensures that all days between the first and last date in the
data are present. It adds an <code>accumulate</code> column that indicates whether
modelled observations should be accumulated onto a later data point.
point. This is useful for modelling data that is reported less frequently
than daily, e.g. weekly incidence data, as well as other reporting
artifacts such as delayed weekedn reporting. The function can also be used
to fill in missing observations with zeros.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fill_missing</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  missing_dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ignore"</span>, <span class="st">"accumulate"</span>, <span class="st">"zero"</span><span class="op">)</span>,</span>
<span>  missing_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ignore"</span>, <span class="st">"accumulate"</span>, <span class="st">"zero"</span><span class="op">)</span>,</span>
<span>  <span class="va">initial_accumulate</span>,</span>
<span>  obs_column <span class="op">=</span> <span class="st">"confirm"</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame with a <code>date</code> column. The other columns depend on the
model that the data are to be used, e.g. <code><a href="estimate_infections.html">estimate_infections()</a></code> or
<code><a href="estimate_secondary.html">estimate_secondary()</a></code>. See the documentation there for the expected
format. The data must not already have an <code>accumulate</code> function, otherwise
the function will fail with an error.</p></dd>


<dt id="arg-missing-dates">missing_dates<a class="anchor" aria-label="anchor" href="#arg-missing-dates"></a></dt>
<dd><p>Character. Options are "ignore" (the default),
"accumulate" and "zero". This determines how missing dates in the data are
interpreted.  If set to "ignore", any missing dates in the observation
data will be interpreted as missing and skipped in the likelihood. If set
to "accumulate", modelled observations on dates that are missing in the
data will be accumulated and added to the next non-missing data point.
This can be used to model incidence data that is reported less frequently
than daily. In that case, the first data point is not included in the
likelihood (unless <code>initial_accumulate</code> is set to a value greater than
one) but used only to reset modelled observations to zero. If "zero" then
all observations on missing dates will be assumed to be of value 0.</p></dd>


<dt id="arg-missing-obs">missing_obs<a class="anchor" aria-label="anchor" href="#arg-missing-obs"></a></dt>
<dd><p>Character. How to process dates that exist in the data
but have observations with NA values. The options available are the same
ones as for the <code>missing_dates</code> argument.</p></dd>


<dt id="arg-initial-accumulate">initial_accumulate<a class="anchor" aria-label="anchor" href="#arg-initial-accumulate"></a></dt>
<dd><p>Integer. The number of initial dates to accumulate
if <code>missing_dates</code> or <code>missing_obs</code> is set to <code>"accumulate"</code>. This
argument needs ot have a minimum of 1. If it is set to 1 then no
accumulation is happening on the first data point. If it is greater than 1
then dates are added to the beginning of the data set to get be able to
have a sufficient number of modelled observations accumulated onto the
first data point. For modelling weekly incidence data this should be set
to 7. If accumulating and the first data point is not NA and this is
argument is not set, then if all dates in the data have the same gap this
will be taken as initial accumulation and a warning given to inform the
user. If not all gaps are the same the first data point will be removed
with a warning.</p></dd>


<dt id="arg-obs-column">obs_column<a class="anchor" aria-label="anchor" href="#arg-obs-column"></a></dt>
<dd><p>Character (default: "confirm"). If given, only the column
specified here will be used for checking missingness. This is useful if
using a data set that has multiple columns of hwich one of them
corresponds to observations that are to be processed here.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>Character vector. Name(s) of any additional column(s) where
data processing should be done separately for each value in the column.
This is useful when using data representing e.g. multiple geographies. If
NULL (default) no such grouping is done.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data.table with an <code>accumulate</code> column that indicates whether
values are accumulated (see the documentation of the <code>data</code> argument in
<code><a href="estimate_infections.html">estimate_infections()</a></code>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">example_confirmed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## calculate weekly sum</span></span></span>
<span class="r-in"><span><span class="va">cases</span><span class="op">[</span>, <span class="va">confirm</span> <span class="op">:=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/froll.html" class="external-link">frollsum</a></span><span class="op">(</span><span class="va">confirm</span>, <span class="fl">7</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            date confirm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Date&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 2020-02-22      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 2020-02-23      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 2020-02-24      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 2020-02-25      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 2020-02-26      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126: 2020-06-26    1695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127: 2020-06-27    1950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128: 2020-06-28    1861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129: 2020-06-29    1811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130: 2020-06-30    1716</span>
<span class="r-in"><span><span class="co">## limit to dates once a week</span></span></span>
<span class="r-in"><span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="va">cases</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span>, <span class="fl">7</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">## set the second observation to missing</span></span></span>
<span class="r-in"><span><span class="va">cases</span><span class="op">[</span><span class="fl">2</span>, <span class="va">confirm</span> <span class="op">:=</span> <span class="cn">NA</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           date confirm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;Date&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: 2020-02-28     647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: 2020-03-06      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: 2020-03-13   11255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: 2020-03-20   25922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: 2020-03-27   39504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: 2020-04-03   34703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: 2020-04-10   28384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: 2020-04-17   25315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: 2020-04-24   21032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: 2020-05-01   15490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: 2020-05-08   10395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: 2020-05-15    7238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: 2020-05-22    4910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: 2020-05-29    3726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: 2020-06-05    2281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: 2020-06-12    2129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: 2020-06-19    2017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: 2020-06-26    1695</span>
<span class="r-in"><span><span class="co">## fill missing data</span></span></span>
<span class="r-in"><span><span class="fu">fill_missing</span><span class="op">(</span><span class="va">cases</span>, missing_dates <span class="op">=</span> <span class="st">"accumulate"</span>, initial_accumulate <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;date&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            date confirm accumulate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Date&gt;   &lt;num&gt;     &lt;lgcl&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 2020-02-22      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 2020-02-23      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 2020-02-24      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 2020-02-25      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 2020-02-26      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122: 2020-06-22      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123: 2020-06-23      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124: 2020-06-24      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125: 2020-06-25      NA       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126: 2020-06-26    1695      FALSE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Joel Hellewell, Katharine Sherratt, Katelyn Gostic, Joe Hickson, Hamada S. Badr, Michael DeWitt, James M. Azam, EpiForecasts, <a href="https://www.lshtm.ac.uk/aboutus/people/funk.sebastian" class="external-link">Sebastian Funk</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

