<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Prior choice and specification guide • EpiNow2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prior choice and specification guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiNow2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/EpiNow2.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reference" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reference</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reference">
<li><a class="dropdown-item" href="../reference/index.html">R Reference</a></li>
    <li><a class="dropdown-item" href="https://epiforecasts.io/EpiNow2/stan/">Stan Reference</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-model-definitions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Model definitions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-model-definitions">
<li><a class="dropdown-item" href="../articles/estimate_infections.html">estimate_infections()</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_secondary.html">estimate_secondary()</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_truncation.html">estimate_truncation()</a></li>
    <li><a class="dropdown-item" href="../articles/gaussian_process_implementation_details.html">Gaussian Process implementation details</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-usage" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Usage</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-usage">
<li><a class="dropdown-item" href="../articles/estimate_infections_workflow.html">Workflow for Rt estimation and forecasting</a></li>
    <li><a class="dropdown-item" href="../articles/prior_choice_guide.html">Prior choice and specification guide</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_infections_options.html">Examples: estimate_infections()</a></li>
    <li><a class="dropdown-item" href="../articles/epinow.html">Using epinow() for running in production mode</a></li>
    <li><a class="dropdown-item" href="../articles/forecasting_multiple_data_streams.html">Forecasting multiple data streams</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><a class="dropdown-item" href="../articles/case-studies.html">External case studies and use in the literature</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiforecasts/EpiNow2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Prior choice and specification guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/EpiNow2/blob/v1.8.0/vignettes/prior_choice_guide.Rmd" class="external-link"><code>vignettes/prior_choice_guide.Rmd</code></a></small>
      <div class="d-none name"><code>prior_choice_guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides practical guidance on specifying and choosing
priors for <a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a> models. While the package provides
sensible defaults for all priors, understanding when and how to modify
them can improve model performance for your specific application.</p>
<p>This guide covers priors for the three main modelling functions:</p>
<ul>
<li>
<code><a href="../reference/estimate_infections.html">estimate_infections()</a></code> (renewal equation and
non-mechanistic models)</li>
<li>
<code><a href="../reference/estimate_secondary.html">estimate_secondary()</a></code> (secondary observations like
deaths or hospitalizations)</li>
<li>
<code><a href="../reference/estimate_truncation.html">estimate_truncation()</a></code> (truncation distribution
estimation)</li>
</ul>
<p><strong>What this guide covers:</strong></p>
<ul>
<li>A comprehensive table of all priors in <a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a>
</li>
<li>The expected impact of different prior choices</li>
<li>Guidance on when to change defaults</li>
<li>Practical examples of prior specification</li>
</ul>
<p><strong>What this guide does NOT cover:</strong></p>
<ul>
<li>Mathematical derivations (see <a href="estimate_infections.html">Model definition</a>)</li>
<li>Technical implementation details (see <a href="gaussian_process_implementation_details.html">Gaussian Process
implementation details</a>)</li>
<li>General Bayesian prior elicitation theory (see the <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations" class="external-link">Stan
Prior Choice Recommendations</a>)</li>
</ul>
<p><strong>Key principle:</strong> All defaults in
<a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a> aim to provide sensible defaults that work across
a range of pathogens and settings. For a specific application with
domain knowledge, you may benefit from more informative priors.</p>
<blockquote>
<p><strong>Important default:</strong> The default generation time is
<code>Fixed(1)</code>, meaning all transmission occurs after 1 day. With
this default,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
represents the daily exponential growth rate rather than the traditional
reproduction number. For epidemiologically meaningful
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
estimates, you should always specify a realistic generation time
distribution from the literature (see <a href="#generation-time-distribution">Generation time
distribution</a>).</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="set-up">Set up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h2>
<p>We load the <em>EpiNow2</em> package and the <em>posterior</em> and
<em>data.table</em> packages which we will use for convergence
diagnostics and data wrangling, respectively.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'EpiNow2'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Gamma</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/" class="external-link">posterior</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is posterior version 1.6.1.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'posterior'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     mad, sd, var</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %in%, match</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<p>We also set up example data and parameters that will be used in code
examples throughout this vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example data for estimate_infections</span></span>
<span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Example data for estimate_secondary</span></span>
<span><span class="va">secondary_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">example_confirmed</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">secondary_data</span>, <span class="st">"confirm"</span>, <span class="st">"primary"</span><span class="op">)</span></span>
<span><span class="va">secondary_data</span><span class="op">[</span>, <span class="va">scaling</span> <span class="op">:=</span> <span class="fl">0.4</span><span class="op">]</span></span>
<span><span class="va">secondary_data</span><span class="op">[</span>, <span class="va">meanlog</span> <span class="op">:=</span> <span class="fl">1.8</span><span class="op">]</span><span class="op">[</span>, <span class="va">sdlog</span> <span class="op">:=</span> <span class="fl">0.5</span><span class="op">]</span></span>
<span><span class="va">secondary_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convolve_and_scale.html">convolve_and_scale</a></span><span class="op">(</span><span class="va">secondary_data</span>, type <span class="op">=</span> <span class="st">"incidence"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example data for estimate_truncation</span></span>
<span><span class="va">truncation_data</span> <span class="op">&lt;-</span> <span class="va">example_truncated</span></span>
<span></span>
<span><span class="co"># Example delays</span></span>
<span><span class="va">reporting_delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">delay</span> <span class="op">&lt;-</span> <span class="va">example_incubation_period</span> <span class="op">+</span> <span class="va">reporting_delay</span></span>
<span></span>
<span><span class="co"># Fast Stan settings for vignette building</span></span>
<span><span class="co"># (Use default settings for actual analyses)</span></span>
<span><span class="va">stan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_opts.html">stan_opts</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overview-of-all-priors">Overview of all priors<a class="anchor" aria-label="anchor" href="#overview-of-all-priors"></a>
</h2>
<p>The following tables list all priors available in
<a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a>, organised by modelling function.</p>
<div class="section level3">
<h3 id="estimate_infections-priors">estimate_infections() priors<a class="anchor" aria-label="anchor" href="#estimate_infections-priors"></a>
</h3>
<p><code><a href="../reference/estimate_infections.html">estimate_infections()</a></code> supports two models: renewal
equation (default) and non-mechanistic/deconvolution.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="20%">
<col width="12%">
<col width="18%">
<col width="20%">
<col width="16%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th>Component</th>
<th>Model</th>
<th>Function</th>
<th>Parameter</th>
<th>Default</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Reproduction number (Rt)</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Initial R₀ / mean Rt</td>
<td>Renewal only</td>
<td><code><a href="../reference/rt_opts.html">rt_opts()</a></code></td>
<td><code>prior</code></td>
<td><code>LogNormal(mean = 1, sd = 1)</code></td>
<td>When choosing <code>gp_on = "R0"</code>, reverts to this when no
data</td>
</tr>
<tr class="odd">
<td><strong>Random walk</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Step size SD</td>
<td>Renewal only</td>
<td><code><a href="../reference/rt_opts.html">rt_opts()</a></code></td>
<td><code>rw</code></td>
<td><code>HalfNormal(0, 0.1)</code></td>
<td>Set step size via <code>rw</code> argument</td>
</tr>
<tr class="odd">
<td><strong>Gaussian Process</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Length scale</td>
<td>Both</td>
<td><code><a href="../reference/gp_opts.html">gp_opts()</a></code></td>
<td><code>ls</code></td>
<td><code>LogNormal(mean = 21, sd = 7, max = 60)</code></td>
<td>Controls smoothness over time</td>
</tr>
<tr class="odd">
<td>Magnitude</td>
<td>Both</td>
<td><code><a href="../reference/gp_opts.html">gp_opts()</a></code></td>
<td><code>alpha</code></td>
<td><code>Normal(mean = 0, sd = 0.01)</code></td>
<td>Controls amplitude of variations</td>
</tr>
<tr class="even">
<td><strong>Back-calculation</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Prior source</td>
<td>Non-mechanistic only</td>
<td><code><a href="../reference/backcalc_opts.html">backcalc_opts()</a></code></td>
<td><code>prior</code></td>
<td><code>"reports"</code></td>
<td>Options: “reports”, “infections”, “none”</td>
</tr>
<tr class="even">
<td><strong>Observation model</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Overdispersion</td>
<td>Both</td>
<td><code><a href="../reference/obs_opts.html">obs_opts()</a></code></td>
<td><code>dispersion</code></td>
<td><code>Normal(mean = 0, sd = 0.25)</code></td>
<td>1/√φ parameterisation</td>
</tr>
<tr class="even">
<td>Scaling</td>
<td>Both</td>
<td><code><a href="../reference/obs_opts.html">obs_opts()</a></code></td>
<td><code>scale</code></td>
<td><code>Fixed(1)</code></td>
<td>Ascertainment rate</td>
</tr>
<tr class="odd">
<td>Day of week</td>
<td>Both</td>
<td>(internal)</td>
<td>(auto)</td>
<td><code>Dirichlet(1, ..., 1)</code></td>
<td>Turn off via <code>week_effect = FALSE</code>
</td>
</tr>
<tr class="even">
<td><strong>Generation time</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Parameters</td>
<td>Renewal only</td>
<td><code><a href="../reference/generation_time_opts.html">gt_opts()</a></code></td>
<td><code>dist</code></td>
<td><code>Fixed(1)</code></td>
<td>Default: Rt is daily exponential growth rate</td>
</tr>
<tr class="even">
<td><strong>Delays</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Parameters</td>
<td>Both</td>
<td><code><a href="../reference/delay_opts.html">delay_opts()</a></code></td>
<td><code>dist</code></td>
<td><code>Fixed(0)</code></td>
<td>No delay by default</td>
</tr>
<tr class="even">
<td><strong>Truncation</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Distribution</td>
<td>Both</td>
<td><code><a href="../reference/trunc_opts.html">trunc_opts()</a></code></td>
<td><code>dist</code></td>
<td><code>Fixed(0)</code></td>
<td>No truncation by default</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="estimate_secondary-priors">estimate_secondary() priors<a class="anchor" aria-label="anchor" href="#estimate_secondary-priors"></a>
</h3>
<table class="table">
<colgroup>
<col width="22%">
<col width="20%">
<col width="22%">
<col width="18%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th>Component</th>
<th>Function</th>
<th>Parameter</th>
<th>Default</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Delays (primary to secondary)</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Parameters</td>
<td><code><a href="../reference/delay_opts.html">delay_opts()</a></code></td>
<td><code>dist</code></td>
<td><code>LogNormal(meanlog = Normal(2.5, 0.5), sdlog = Normal(0.47, 0.25), max = 30)</code></td>
<td>Time from primary to secondary event</td>
</tr>
<tr class="odd">
<td><strong>Observation model</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Scaling</td>
<td><code><a href="../reference/obs_opts.html">obs_opts()</a></code></td>
<td><code>scale</code></td>
<td><code>Fixed(1)</code></td>
<td>Fraction of primary events leading to secondary</td>
</tr>
<tr class="odd">
<td>Overdispersion</td>
<td><code><a href="../reference/obs_opts.html">obs_opts()</a></code></td>
<td><code>dispersion</code></td>
<td><code>Normal(mean = 0, sd = 0.25)</code></td>
<td>1/√φ parameterisation</td>
</tr>
<tr class="even">
<td>Day of week</td>
<td>(internal)</td>
<td>(auto)</td>
<td><code>Dirichlet(1, ..., 1)</code></td>
<td>Turn off via <code>week_effect = FALSE</code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="estimate_truncation-priors">estimate_truncation() priors<a class="anchor" aria-label="anchor" href="#estimate_truncation-priors"></a>
</h3>
<table class="table">
<colgroup>
<col width="22%">
<col width="20%">
<col width="22%">
<col width="18%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th>Component</th>
<th>Function</th>
<th>Parameter</th>
<th>Default</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Truncation distribution</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Parameters</td>
<td><code><a href="../reference/trunc_opts.html">trunc_opts()</a></code></td>
<td><code>dist</code></td>
<td><code>LogNormal(meanlog = Normal(0, 1), sdlog = Normal(1, 1), max = 10)</code></td>
<td>Describes reporting delays</td>
</tr>
<tr class="odd">
<td><strong>Observation model</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Overdispersion</td>
<td>(internal)</td>
<td>(auto)</td>
<td><code>HalfNormal(0, 1)</code></td>
<td>1/√φ parameterisation; not directly adjustable</td>
</tr>
<tr class="odd">
<td>Noise term</td>
<td>(internal)</td>
<td>(auto)</td>
<td><code>HalfNormal(0, 1)</code></td>
<td>Not directly adjustable</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="prior-impacts-and-choice-guidance">Prior impacts and choice guidance<a class="anchor" aria-label="anchor" href="#prior-impacts-and-choice-guidance"></a>
</h2>
<p>This section explains what effects you can expect from modifying each
prior, and when you might want to do so.</p>
<div class="section level3">
<h3 id="reproduction-number">Reproduction number<a class="anchor" aria-label="anchor" href="#reproduction-number"></a>
</h3>
<p><strong>What it controls:</strong> The prior distribution for the
reproduction number. Its role depends on the Gaussian Process
specification:</p>
<ul>
<li>
<strong>Differenced GP</strong> (default,
<code>gp_on = "R_t-1"</code>): This is the prior for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
at the start of the time series. When there is no data (e.g., early in
the time series before the seeding period ends, or when doing real-time
estimates of delayed quantities),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
reverts to the last estimated value but with expanding uncertainty as
the zero-centered GP of differences continues.</li>
<li>
<strong>Stationary GP</strong> (<code>gp_on = "R0"</code>): This is
the prior mean that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
reverts to throughout the time series when there is no data (e.g., early
in the time series, or near the present when there are delays). Useful
when you want estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
to return to a baseline value in the absence of information.</li>
</ul>
<p><strong>Default:</strong>
<code>LogNormal(mean = 1, sd = 1)</code></p>
<p>This default corresponds to a median of 1 (range 0.4 to 2.7 at 95%
prior probability), centred on the epidemic threshold.</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Tighter prior (smaller <code>sd</code>)</strong>: Speeds up
MCMC convergence if your prior is accurate, but may bias estimates if
wrong. Use when you have strong prior knowledge about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
for your pathogen.</li>
<li>
<strong>Higher mean</strong>: Shifts the initial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
estimate upward (differenced) or provides a higher reversion point
(stationary). Use for fast-spreading pathogens based on prior knowledge
from the literature.</li>
<li>
<strong>Wider prior (larger <code>sd</code>)</strong>: More flexible
but may lead to slower convergence and/or identifiability problems. Use
when very uncertain about initial dynamics.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>You have reliable estimates from similar outbreaks or the
literature</li>
<li>You’re analysing a well-characterised pathogen (e.g., influenza
pandemic with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
typically 1.5-2.5, or emerging outbreaks of measles in immunologically
naive populations)</li>
<li>Using stationary GP and want a specific baseline for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
to revert to</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For a measles outbreak with strong prior knowledge</span></span>
<span><span class="fu"><a href="../reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $use_rt</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rw</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $use_breakpoints</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $future</span></span>
<span><span class="co">#&gt; [1] "latest"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gp_on</span></span>
<span><span class="co">#&gt; [1] "R_t-1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_period</span></span>
<span><span class="co">#&gt; [1] "forecast"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_floor</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $growth_method</span></span>
<span><span class="co">#&gt; [1] "infections"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop</span></span>
<span><span class="co">#&gt; - fixed value:</span></span>
<span><span class="co">#&gt;   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior</span></span>
<span><span class="co">#&gt; - lognormal distribution:</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     2.7</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "rt_opts" "list"</span></span>
<span></span>
<span><span class="co"># For uncertain but likely growing outbreak</span></span>
<span><span class="fu"><a href="../reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $use_rt</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rw</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $use_breakpoints</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $future</span></span>
<span><span class="co">#&gt; [1] "latest"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gp_on</span></span>
<span><span class="co">#&gt; [1] "R_t-1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_period</span></span>
<span><span class="co">#&gt; [1] "forecast"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_floor</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $growth_method</span></span>
<span><span class="co">#&gt; [1] "infections"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop</span></span>
<span><span class="co">#&gt; - fixed value:</span></span>
<span><span class="co">#&gt;   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior</span></span>
<span><span class="co">#&gt; - lognormal distribution:</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     0.58</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.47</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "rt_opts" "list"</span></span>
<span></span>
<span><span class="co"># Stationary GP reverting to R_t = 2 when no data</span></span>
<span><span class="fu"><a href="../reference/rt_opts.html">rt_opts</a></span><span class="op">(</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  gp_on <span class="op">=</span> <span class="st">"R0"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $use_rt</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rw</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $use_breakpoints</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $future</span></span>
<span><span class="co">#&gt; [1] "latest"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gp_on</span></span>
<span><span class="co">#&gt; [1] "R0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_period</span></span>
<span><span class="co">#&gt; [1] "forecast"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_floor</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $growth_method</span></span>
<span><span class="co">#&gt; [1] "infections"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop</span></span>
<span><span class="co">#&gt; - fixed value:</span></span>
<span><span class="co">#&gt;   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior</span></span>
<span><span class="co">#&gt; - lognormal distribution:</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     0.66</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "rt_opts" "list"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gaussian-process-length-scale">Gaussian Process length scale<a class="anchor" aria-label="anchor" href="#gaussian-process-length-scale"></a>
</h3>
<p><strong>What it controls:</strong> The smoothness of changes in the
reproduction number over time, measured in days. Larger values =
smoother changes; smaller values = more rapid fluctuations.</p>
<p><strong>Default:</strong>
<code>LogNormal(mean = 21, sd = 7, max = 60)</code></p>
<p>This corresponds to a median of 21 days (range 9 to 36 days at 95%
prior probability), reflecting gradual changes typical of epidemics with
interventions happening over weeks.</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Shorter length scale (smaller <code>mean</code>)</strong>:
Allows
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
to change more rapidly day-to-day. Results in less smooth
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
estimates that can track sudden changes (e.g., lockdowns) more quickly.
May overfit to noise if too short.</li>
<li>
<strong>Longer length scale (larger <code>mean</code>)</strong>:
Forces smoother
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
changes over time. More stable estimates but may miss rapid shifts in
transmission. Can undersmooth if too long.</li>
<li>
<strong>Wider uncertainty (larger <code>sd</code>)</strong>: Lets
the data determine the smoothness. More flexible but computationally
expensive.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>
<strong>Shorter (mean ~7-14 days)</strong>: When expecting rapid
policy changes, modelling short outbreaks, or seeing sudden shifts in
data</li>
<li>
<strong>Longer (mean ~28+ days)</strong>: When transmission changes
gradually, in stable endemic settings, or with noisy data</li>
<li>
<strong>Maximum adjustment</strong>: Set <code>max</code> lower if
working with short time series (e.g., <code>max=30</code> for 60-day
outbreak)</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For outbreak with weekly policy changes</span></span>
<span><span class="fu"><a href="../reference/gp_opts.html">gp_opts</a></span><span class="op">(</span>ls <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">7</span>, sd <span class="op">=</span> <span class="fl">3</span>, max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $basis_prop</span></span>
<span><span class="co">#&gt; [1] 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $boundary_scale</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ls</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 30):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     1.9</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.41</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kernel</span></span>
<span><span class="co">#&gt; [1] "matern"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $matern_order</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "gp_opts" "list"</span></span>
<span></span>
<span><span class="co"># For gradually evolving endemic disease</span></span>
<span><span class="fu"><a href="../reference/gp_opts.html">gp_opts</a></span><span class="op">(</span>ls <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">28</span>, sd <span class="op">=</span> <span class="fl">10</span>, max <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $basis_prop</span></span>
<span><span class="co">#&gt; [1] 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $boundary_scale</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ls</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 90):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     3.3</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.35</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kernel</span></span>
<span><span class="co">#&gt; [1] "matern"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $matern_order</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "gp_opts" "list"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gaussian-process-magnitude">Gaussian Process magnitude<a class="anchor" aria-label="anchor" href="#gaussian-process-magnitude"></a>
</h3>
<p><strong>What it controls:</strong> The amplitude of variations in the
Gaussian Process.</p>
<ul>
<li>
<strong>For renewal equation model</strong>: This controls
variations in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(R_t)</annotation></semantics></math>
and is the prior standard deviation around the GP trend (stationary GP)
or around zero (differenced GP).</li>
<li>
<strong>For non-mechanistic model</strong>: This controls variations
in log infections directly, and typically requires a less constrained
prior since it scales with the infection level rather than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>.</li>
</ul>
<p><strong>Default:</strong>
<code>Normal(mean = 0, sd = 0.01)</code></p>
<p>For the renewal equation model, this corresponds to a half-normal
(since negative values are truncated) with 95% of prior mass below 0.02,
reflecting small changes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(R_t)</annotation></semantics></math>.</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Larger <code>sd</code> (e.g., 0.05-0.1)</strong>: Allows
bigger jumps over time. Useful for outbreaks with large, real variations
in transmission (e.g., due to major interventions) or for
non-mechanistic models. May overfit if too large.</li>
<li>
<strong>Smaller <code>sd</code> (e.g., 0.005)</strong>: Constrains
to change very gradually. Good for stable situations or very noisy data.
May underfit real changes if too small.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>
<strong>Larger</strong>: Modelling outbreaks with major
interventions (lockdowns, vaccination campaigns), high real variation,
or using the non-mechanistic model</li>
<li>
<strong>Smaller</strong>: Modelling stable endemic transmission or
when data is very noisy relative to sample size</li>
<li>
<strong>Note</strong>: The default works well for the renewal
equation model in most scenarios, but may need adjustment for the
non-mechanistic model</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For outbreak with major interventions</span></span>
<span><span class="fu"><a href="../reference/gp_opts.html">gp_opts</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $basis_prop</span></span>
<span><span class="co">#&gt; [1] 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $boundary_scale</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ls</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 60):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     3</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.32</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kernel</span></span>
<span><span class="co">#&gt; [1] "matern"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $matern_order</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "gp_opts" "list"</span></span>
<span></span>
<span><span class="co"># For very stable transmission</span></span>
<span><span class="fu"><a href="../reference/gp_opts.html">gp_opts</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $basis_prop</span></span>
<span><span class="co">#&gt; [1] 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $boundary_scale</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ls</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 60):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     3</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.32</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.005</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kernel</span></span>
<span><span class="co">#&gt; [1] "matern"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $matern_order</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "gp_opts" "list"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="random-walk-for-r_t-alternative-to-gp">Random walk for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
(alternative to GP)<a class="anchor" aria-label="anchor" href="#random-walk-for-r_t-alternative-to-gp"></a>
</h3>
<p><strong>What it controls:</strong> Step-wise changes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
at fixed intervals instead of smooth GP changes.</p>
<p><strong>Default:</strong> Not used (GP is default). When enabled via
<code>rt_opts(rw = 7)</code>, the prior SD is
<code>HalfNormal(0, 0.1)</code>.</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Shorter steps (e.g., <code>rw = 1</code>)</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
can change daily. Very flexible, like a short GP length scale. Fast to
compute but may overfit.</li>
<li>
<strong>Longer steps (e.g., <code>rw = 7</code> or
<code>rw = 14</code>)</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
constant within each week/fortnight. Appropriate when transmission
changes are discrete (policy changes) rather than continuous.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>Use random walk instead of GP when you believe transmission changes
are discrete rather than smooth</li>
<li>Use weekly (<code>rw = 7</code>) when transmission dynamics change
at weekly intervals</li>
<li>Use daily (<code>rw = 1</code>) for maximum flexibility with fast
computation (but risk overfitting)</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Weekly step changes</span></span>
<span><span class="va">fit_rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_infections.html">estimate_infections</a></span><span class="op">(</span></span>
<span>  <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu"><a href="../reference/generation_time_opts.html">gt_opts</a></span><span class="op">(</span><span class="va">example_generation_time</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="../reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, rw <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>  gp <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Disable GP when using random walk</span></span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat</span></span>
<span><span class="co">#&gt; Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span><span class="co">#&gt; Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="observation-model-overdispersion">Observation model: overdispersion<a class="anchor" aria-label="anchor" href="#observation-model-overdispersion"></a>
</h3>
<p><strong>What it controls:</strong> How much extra variability exists
in reported cases beyond Poisson variation. The parameter is 1/√φ where
φ is the negative binomial overdispersion.</p>
<p><strong>Default:</strong>
<code>Normal(mean = 0, sd = 0.25)</code></p>
<p>With truncation at 0, this half-normal has 95% prior mass below 0.5,
corresponding to moderate overdispersion.</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Larger <code>sd</code> (e.g., 0.5-1.0)</strong>: Allows for
more overdispersion, meaning reported counts can be much more variable
than a Poisson model. Use with highly variable reporting systems.</li>
<li>
<strong>Smaller <code>sd</code> (e.g., 0.1)</strong>: Tighter around
Poisson variance. Use for high-quality surveillance with consistent
reporting.</li>
<li>
<strong>Change to Poisson</strong>: Set
<code>family = "poisson"</code> in <code><a href="../reference/obs_opts.html">obs_opts()</a></code>. Appropriate
for large, stable counts with minimal extra variation.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>
<strong>More dispersed</strong>: Weekend effects, variable testing
capacity, small outbreak counts, or low-resource settings</li>
<li>
<strong>Less dispersed</strong>: Large outbreaks with stable
reporting infrastructure</li>
<li>
<strong>Switch to Poisson</strong>: Very large counts (&gt;1000s
daily) from stable reporting systems and when confident in model
specification. Note that negative binomial overdispersion can absorb
model misspecification, so switching to Poisson requires both
high-quality data and confidence that the model structure is
appropriate.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For highly variable reporting</span></span>
<span><span class="fu"><a href="../reference/obs_opts.html">obs_opts</a></span><span class="op">(</span>dispersion <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $family</span></span>
<span><span class="co">#&gt; [1] "negbin"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dispersion</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_effect</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_length</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scale</span></span>
<span><span class="co">#&gt; - fixed value:</span></span>
<span><span class="co">#&gt;   1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accumulate</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $likelihood</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $return_likelihood</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $na_as_missing_default_used</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "obs_opts" "list"</span></span>
<span></span>
<span><span class="co"># For stable, high-quality surveillance</span></span>
<span><span class="fu"><a href="../reference/obs_opts.html">obs_opts</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>  <span class="co"># No dispersion parameter needed</span></span>
<span><span class="co">#&gt; $family</span></span>
<span><span class="co">#&gt; [1] "poisson"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dispersion</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_effect</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_length</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scale</span></span>
<span><span class="co">#&gt; - fixed value:</span></span>
<span><span class="co">#&gt;   1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accumulate</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $likelihood</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $return_likelihood</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $na_as_missing_default_used</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "obs_opts" "list"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="observation-model-scaling">Observation model: scaling<a class="anchor" aria-label="anchor" href="#observation-model-scaling"></a>
</h3>
<p><strong>What it controls:</strong> The <code>scale</code> parameter
in <code><a href="../reference/obs_opts.html">obs_opts()</a></code> is shared by both
<code><a href="../reference/estimate_infections.html">estimate_infections()</a></code> and
<code><a href="../reference/estimate_secondary.html">estimate_secondary()</a></code>, but represents different quantities
in each context:</p>
<ul>
<li>
<strong>For <code><a href="../reference/estimate_infections.html">estimate_infections()</a></code></strong>: The
proportion of infections that are ultimately reported (ascertainment
rate)</li>
<li>
<strong>For <code><a href="../reference/estimate_secondary.html">estimate_secondary()</a></code></strong>: The fraction
of primary events leading to secondary events (e.g., case fatality rate,
hospitalization rate)</li>
</ul>
<p><strong>Default:</strong> <code>Fixed(1)</code> for both
functions</p>
<p>For <code><a href="../reference/estimate_infections.html">estimate_infections()</a></code>, this assumes all infections
are reported. For <code><a href="../reference/estimate_secondary.html">estimate_secondary()</a></code>, this assumes a 1:1
relationship between primary and secondary events (which is rarely
realistic).</p>
<p><strong>Expected impact of changes:</strong></p>
<div class="section level4">
<h4 id="for-estimate_infections">For estimate_infections():<a class="anchor" aria-label="anchor" href="#for-estimate_infections"></a>
</h4>
<ul>
<li>
<strong>Estimate scaling (e.g.,
<code>Normal(mean=0.3, sd=0.1)</code>)</strong>: Allows model to
estimate underreporting. Reported cases = scaling × latent infections ×
delay convolution. Useful when you know reporting is incomplete but
don’t know the rate.</li>
<li>
<strong>Fixed lower value (e.g., <code>Fixed(0.5)</code>)</strong>:
Assumes you know 50% are reported. Changes interpretation of infections
but not
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="for-estimate_secondary">For estimate_secondary():<a class="anchor" aria-label="anchor" href="#for-estimate_secondary"></a>
</h4>
<ul>
<li>
<strong>Tight prior (e.g.,
<code>Normal(mean=0.01, sd=0.005)</code>)</strong>: Constrains estimates
near prior (e.g., 1% case fatality rate), faster convergence</li>
<li>
<strong>Wide prior (e.g.,
<code>Normal(mean=0.05, sd=0.05)</code>)</strong>: Flexible but may be
poorly identified without long time series</li>
</ul>
<p><strong>When to modify:</strong></p>
</div>
<div class="section level4">
<h4 id="for-estimate_infections-1">For estimate_infections():<a class="anchor" aria-label="anchor" href="#for-estimate_infections-1"></a>
</h4>
<ul>
<li>
<strong>Nearly always keep at <code>Fixed(1)</code></strong> and
interpret “infections” as “reported infections”</li>
<li>
<strong>Estimate only if</strong>: You have external data to anchor
scale (seroprevalence, death rates) AND can set an informative prior on
the ascertainment rate</li>
<li>
<strong>Identifiability warning</strong>: Scaling and initial
infections are weakly identified; estimating scale can cause convergence
issues without strong external information</li>
</ul>
</div>
<div class="section level4">
<h4 id="for-estimate_secondary-1">For estimate_secondary():<a class="anchor" aria-label="anchor" href="#for-estimate_secondary-1"></a>
</h4>
<ul>
<li>
<strong>Always specify</strong> based on domain knowledge (unlike
<code><a href="../reference/estimate_infections.html">estimate_infections()</a></code>, the default of 1 is rarely
appropriate)</li>
<li>Use tighter priors with external estimates (e.g., infection fatality
rate from serology studies)</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate_infections(): Estimating with informative prior from serology</span></span>
<span><span class="fu"><a href="../reference/obs_opts.html">obs_opts</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.2</span>, sd <span class="op">=</span> <span class="fl">0.05</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $family</span></span>
<span><span class="co">#&gt; [1] "negbin"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dispersion</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_effect</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_length</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scale</span></span>
<span><span class="co">#&gt; - normal distribution (max: 1):</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0.2</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accumulate</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $likelihood</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $return_likelihood</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $na_as_missing_default_used</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "obs_opts" "list"</span></span>
<span></span>
<span><span class="co"># estimate_infections(): Fixed known ascertainment (rarely used)</span></span>
<span><span class="fu"><a href="../reference/obs_opts.html">obs_opts</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Fixed</a></span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $family</span></span>
<span><span class="co">#&gt; [1] "negbin"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dispersion</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_effect</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_length</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scale</span></span>
<span><span class="co">#&gt; - fixed value:</span></span>
<span><span class="co">#&gt;   0.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accumulate</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $likelihood</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $return_likelihood</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $na_as_missing_default_used</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "obs_opts" "list"</span></span>
<span></span>
<span><span class="co"># estimate_secondary(): Case fatality rate ~1% with uncertainty</span></span>
<span><span class="fu"><a href="../reference/obs_opts.html">obs_opts</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.01</span>, sd <span class="op">=</span> <span class="fl">0.005</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $family</span></span>
<span><span class="co">#&gt; [1] "negbin"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dispersion</span></span>
<span><span class="co">#&gt; - normal distribution:</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_effect</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $week_length</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scale</span></span>
<span><span class="co">#&gt; - normal distribution (max: 1):</span></span>
<span><span class="co">#&gt;   mean:</span></span>
<span><span class="co">#&gt;     0.01</span></span>
<span><span class="co">#&gt;   sd:</span></span>
<span><span class="co">#&gt;     0.005</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accumulate</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $likelihood</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $return_likelihood</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $na_as_missing_default_used</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "obs_opts" "list"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="generation-time-distribution">Generation time distribution<a class="anchor" aria-label="anchor" href="#generation-time-distribution"></a>
</h3>
<p><strong>What it controls:</strong> The distribution of times from
infection of a primary case to infection of secondary cases. Fundamental
to the renewal equation.</p>
<p><strong>Default:</strong> <code>Fixed(1)</code> (all transmission
after 1 day - leads to Rt = exponential growth rate)</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Uncertain vs fixed</strong>: Specifying parameters with
uncertainty (e.g.,
<code>Gamma(shape = Normal(3, 1), rate = Normal(2, 0.5))</code>) lets
the model learn from data but may be slow or poorly identified with
short time series.</li>
<li>
<strong>Different distribution shape</strong>: Affects how past
infections contribute to current transmission. Longer generation times
smooth the infection curve and affect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
dynamics.</li>
<li>
<strong><code>weight_prior</code> option</strong>: Default
<code>TRUE</code> weights the prior by data length, keeping parameters
near their priors. Set <code>FALSE</code> to allow more learning from
data, though this may not always be identifiable so may lead to fitting
and/or interpretation issues.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>
<strong>Always specify from literature</strong> unless you have only
1-day generation time</li>
<li>
<strong>Use uncertain parameters</strong> when generation time
estimates are themselves uncertain and you have long time series (&gt;60
days)</li>
<li>
<strong>Use fixed parameters</strong> when generation time is
well-established or time series is short</li>
<li>
<strong><code>weight_prior = FALSE</code></strong> can be tried if
you believe the generation time should be learned from data, though
results may vary</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Well-established generation time (COVID-19 example)</span></span>
<span><span class="fu"><a href="../reference/generation_time_opts.html">gt_opts</a></span><span class="op">(</span><span class="va">example_generation_time</span><span class="op">)</span>  <span class="co"># Uses package data</span></span>
<span><span class="co">#&gt; - gamma distribution (max: 14):</span></span>
<span><span class="co">#&gt;   shape:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         1.4</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.48</span></span>
<span><span class="co">#&gt;   rate:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         0.38</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.25</span></span>
<span></span>
<span><span class="co"># Custom uncertain generation time</span></span>
<span><span class="fu"><a href="../reference/generation_time_opts.html">gt_opts</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/Distributions.html">Gamma</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    rate <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fl">14</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; - gamma distribution (max: 14):</span></span>
<span><span class="co">#&gt;   shape:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         3</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.5</span></span>
<span><span class="co">#&gt;   rate:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         2</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.3</span></span>
<span></span>
<span><span class="co"># Custom fixed generation time</span></span>
<span><span class="fu"><a href="../reference/generation_time_opts.html">gt_opts</a></span><span class="op">(</span><span class="fu"><a href="../reference/Distributions.html">Gamma</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.5</span>, rate <span class="op">=</span> <span class="fl">1.5</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; - gamma distribution (max: 10):</span></span>
<span><span class="co">#&gt;   shape:</span></span>
<span><span class="co">#&gt;     2.5</span></span>
<span><span class="co">#&gt;   rate:</span></span>
<span><span class="co">#&gt;     1.5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="delays-incubation-and-reporting">Delays (incubation and reporting)<a class="anchor" aria-label="anchor" href="#delays-incubation-and-reporting"></a>
</h3>
<p><strong>What it controls:</strong> The time from infection to
observation (e.g., symptom onset + reporting delay).</p>
<p><strong>Default:</strong> <code>Fixed(0)</code> (no delay, observe
infections immediately)</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Adding delays shifts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
back in time</strong>: If there is a 7-day delay,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
estimates reflect transmission 7 days earlier. Critical for real-time
inference.</li>
<li>
<strong>Uncertain vs fixed delays</strong>: Uncertain parameters
increase computation time and may be poorly identified. Use fixed delays
from literature when possible.</li>
<li>
<strong><code>weight_prior</code> option</strong>: Default
<code>TRUE</code>. Works like generation time weighting.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>
<strong>Always add delays</strong> matching your data (incubation
period for symptom onset dates, plus reporting delay)</li>
<li>
<strong>Use uncertain parameters</strong> when delays themselves are
uncertain AND you have long time series</li>
<li>
<strong>Use fixed parameters</strong> (recommended) when delays are
known from external studies</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simple fixed delay</span></span>
<span><span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">1.6</span>, sdlog <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 10):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     1.6</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.5</span></span>
<span></span>
<span><span class="co"># Combined incubation + reporting delay (additive)</span></span>
<span><span class="va">incubation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">1.6</span>, sdlog <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">reporting</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">0.5</span>, sdlog <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">incubation</span> <span class="op">+</span> <span class="va">reporting</span><span class="op">)</span></span>
<span><span class="co">#&gt; Composite distribution:</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 10):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     1.6</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.5</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 5):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     0.5</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.5</span></span>
<span></span>
<span><span class="co"># Uncertain delay (advanced)</span></span>
<span><span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span></span>
<span>    meanlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">1.6</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    sdlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 10):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         1.6</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.1</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         0.5</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="truncation">Truncation<a class="anchor" aria-label="anchor" href="#truncation"></a>
</h3>
<p><strong>What it controls:</strong> Right-truncation of recent data
due to reporting delays (recent counts will be revised upward).</p>
<p><strong>Default:</strong> No truncation (<code>Fixed(0)</code>)</p>
<p><strong>Expected impact of changes:</strong></p>
<ul>
<li>
<strong>Adding truncation adjusts recent estimates upward</strong>:
Recent case counts are deflated by the probability they’re observed by
time T.</li>
<li>
<strong><code>weight_prior</code> option</strong>: Default
<code>FALSE</code> (unlike generation time and delays). Truncation
typically doesn’t need data-length weighting.</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>
<strong>Add truncation</strong> when your data is subject to
reporting delays that cause recent counts to be systematically low</li>
<li>
<strong>Estimate truncation</strong> separately using
<code><a href="../reference/estimate_truncation.html">estimate_truncation()</a></code> on data with known revision
history</li>
<li>
<strong>Use informed prior</strong> from data with known revisions
if available</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Known truncation from external analysis</span></span>
<span><span class="fu"><a href="../reference/trunc_opts.html">trunc_opts</a></span><span class="op">(</span><span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.5</span>, sd <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 3):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     -1</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     0.83</span></span>
<span></span>
<span><span class="co"># Estimated truncation (run separately first)</span></span>
<span><span class="va">truncation_estimate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_truncation.html">estimate_truncation</a></span><span class="op">(</span></span>
<span>  <span class="va">truncation_data</span>,</span>
<span>  truncation <span class="op">=</span> <span class="fu"><a href="../reference/trunc_opts.html">trunc_opts</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span></span>
<span>      meanlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      sdlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      max <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Then use in estimate_infections</span></span>
<span><span class="fu"><a href="../reference/trunc_opts.html">trunc_opts</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span><span class="va">truncation_estimate</span><span class="op">)</span><span class="op">[[</span><span class="st">"truncation"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; - lognormal distribution (max: 10):</span></span>
<span><span class="co">#&gt;   meanlog:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         0.9</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.005</span></span>
<span><span class="co">#&gt;   sdlog:</span></span>
<span><span class="co">#&gt;     - normal distribution:</span></span>
<span><span class="co">#&gt;       mean:</span></span>
<span><span class="co">#&gt;         0.6</span></span>
<span><span class="co">#&gt;       sd:</span></span>
<span><span class="co">#&gt;         0.007</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-choice-in-estimate_infections">Model choice in estimate_infections()<a class="anchor" aria-label="anchor" href="#model-choice-in-estimate_infections"></a>
</h3>
<p><code><a href="../reference/estimate_infections.html">estimate_infections()</a></code> supports two models, each with
different prior requirements:</p>
<p><strong>Renewal equation model</strong> (default,
<code>rt != NULL</code>):</p>
<ul>
<li>Models infections via renewal equation using reproduction
number</li>
<li>
<strong>Requires</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
prior, generation time, GP or random walk for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
dynamics</li>
<li>
<strong>Use when</strong>: You want explicit epidemiological
interpretation via
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
</li>
<li>
<strong>Best for</strong>: Most epidemic modelling scenarios</li>
</ul>
<p><strong>Non-mechanistic model</strong> (<code>rt = NULL</code>):</p>
<ul>
<li>Models infections directly with GP, no explicit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
in model</li>
<li>
<strong>Requires</strong>: Back-calculation prior, no generation
time needed</li>
<li>
<strong>Use when</strong>: Faster computation needed, or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
interpretation less important</li>
<li>
<strong>Best for</strong>: Quick analyses, forecasting without
mechanistic detail</li>
<li>
<strong>Warning</strong>: This is a less epidemiologically informed
model than the renewal equation model and may lead to undesired
behaviour, particularly when extrapolating or forecasting</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Renewal equation model (default)</span></span>
<span><span class="va">fit_renewal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_infections.html">estimate_infections</a></span><span class="op">(</span></span>
<span>  <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu"><a href="../reference/generation_time_opts.html">gt_opts</a></span><span class="op">(</span><span class="va">example_generation_time</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="../reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: There were 1 chains where the estimated Bayesian Fraction of Missing Information was low. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bfmi-low</span></span>
<span><span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></span>
<span><span class="co">#&gt; Warning: The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat</span></span>
<span><span class="co">#&gt; Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span><span class="co">#&gt; Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess</span></span>
<span></span>
<span><span class="co"># Non-mechanistic model</span></span>
<span><span class="va">fit_nonmech</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_infections.html">estimate_infections</a></span><span class="op">(</span></span>
<span>  <span class="va">reported_cases</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># No Rt estimation</span></span>
<span>  backcalc <span class="op">=</span> <span class="fu"><a href="../reference/backcalc_opts.html">backcalc_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"reports"</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: ! No generation time distribution given. Using a fixed generation time of 1</span></span>
<span><span class="co">#&gt;   day, i.e. the reproduction number is the same as the daily growth rate.</span></span>
<span><span class="co">#&gt; ℹ If this was intended then this warning can be silenced by setting `dist =</span></span>
<span><span class="co">#&gt;   Fixed(1)`'.</span></span>
<span><span class="co">#&gt; Warning: The largest R-hat is 1.15, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat</span></span>
<span><span class="co">#&gt; Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span><span class="co">#&gt; Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="priors-for-estimate_secondary">Priors for estimate_secondary()<a class="anchor" aria-label="anchor" href="#priors-for-estimate_secondary"></a>
</h3>
<p><code><a href="../reference/estimate_secondary.html">estimate_secondary()</a></code> models secondary observations
(deaths, hospitalizations) from primary observations (cases, admissions)
with a delay and scaling.</p>
<p><strong>Key priors:</strong></p>
<div class="section level4">
<h4 id="delay-between-primary-and-secondary">Delay between primary and secondary<a class="anchor" aria-label="anchor" href="#delay-between-primary-and-secondary"></a>
</h4>
<p><strong>What it controls:</strong> Time from primary event to
secondary event (e.g., case to death).</p>
<p><strong>Default:</strong>
<code>LogNormal(meanlog = Normal(2.5, 0.5), sdlog = Normal(0.47, 0.25), max = 30)</code></p>
<p><strong>Expected impact:</strong></p>
<ul>
<li>
<strong>Uncertain parameters</strong>: Allow model to learn delay
from data, but require longer time series (&gt;30 days)</li>
<li>
<strong>Fixed parameters</strong>: Faster, more stable with short
time series</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>Use literature estimates when available (e.g., case-to-death ~14-21
days for COVID-19)</li>
<li>Make uncertain only with long time series and uncertain external
estimates</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fixed delay from literature</span></span>
<span><span class="va">fit_secondary_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_secondary.html">estimate_secondary</a></span><span class="op">(</span></span>
<span>  <span class="va">secondary_data</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">14</span>, sd <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 1): The largest R-hat is 1.07, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 2): The largest R-hat is 1.07, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 1): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 2): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 1): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 2): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess -</span></span>
<span></span>
<span><span class="co"># Uncertain delay (long time series)</span></span>
<span><span class="va">fit_secondary_uncertain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_secondary.html">estimate_secondary</a></span><span class="op">(</span></span>
<span>  <span class="va">secondary_data</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span></span>
<span>      meanlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>      sdlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>      max <span class="op">=</span> <span class="fl">30</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 1): The largest R-hat is 1.52, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 2): The largest R-hat is 1.52, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 1): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 2): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 1): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:48] estimate_secondary (chain: 2): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess -</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="priors-for-estimate_truncation">Priors for estimate_truncation()<a class="anchor" aria-label="anchor" href="#priors-for-estimate_truncation"></a>
</h3>
<p><code><a href="../reference/estimate_truncation.html">estimate_truncation()</a></code> estimates the distribution of
reporting delays that cause recent data to be revised upward over
time.</p>
<p><strong>Key priors:</strong></p>
<div class="section level4">
<h4 id="truncation-distribution-parameters">Truncation distribution parameters<a class="anchor" aria-label="anchor" href="#truncation-distribution-parameters"></a>
</h4>
<p><strong>What it controls:</strong> The lognormal distribution
describing reporting delays.</p>
<p><strong>Default:</strong>
<code>LogNormal(meanlog = Normal(0, 1), sdlog = Normal(1, 1), max = 10)</code></p>
<p><strong>Expected impact:</strong></p>
<ul>
<li>
<strong>Tighter priors</strong>: Faster convergence if you have
prior knowledge of typical delays</li>
<li>
<strong>Wider priors</strong>: More flexible but may be poorly
identified</li>
</ul>
<p><strong>When to modify:</strong></p>
<ul>
<li>Use informative priors if you have data on typical reporting
delays</li>
<li>Common reporting delays: 1-3 days (test results), 7-14 days (death
reporting)</li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick turnaround testing (1-3 days typical delay)</span></span>
<span><span class="va">fit_trunc_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_truncation.html">estimate_truncation</a></span><span class="op">(</span></span>
<span>  <span class="va">truncation_data</span>,</span>
<span>  truncation <span class="op">=</span> <span class="fu"><a href="../reference/trunc_opts.html">trunc_opts</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span></span>
<span>      meanlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>,  <span class="co"># ~1.6 day median delay</span></span>
<span>      sdlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>      max <span class="op">=</span> <span class="fl">7</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:49] estimate_truncation (chain: 1): The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:49] estimate_truncation (chain: 2): The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:49] estimate_truncation (chain: 1): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:49] estimate_truncation (chain: 2): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:49] estimate_truncation (chain: 1): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:49] estimate_truncation (chain: 2): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess -</span></span>
<span></span>
<span><span class="co"># Slower reporting (e.g., deaths, 7-14 days)</span></span>
<span><span class="va">fit_trunc_slow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_truncation.html">estimate_truncation</a></span><span class="op">(</span></span>
<span>  <span class="va">truncation_data</span>,</span>
<span>  truncation <span class="op">=</span> <span class="fu"><a href="../reference/trunc_opts.html">trunc_opts</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span></span>
<span>      meanlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span>,  <span class="co"># ~7 day median delay</span></span>
<span>      sdlog <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">Normal</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>      max <span class="op">=</span> <span class="fl">21</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:50] estimate_truncation (chain: 1): The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:50] estimate_truncation (chain: 2): The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:50] estimate_truncation (chain: 1): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:50] estimate_truncation (chain: 2): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess -</span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:50] estimate_truncation (chain: 1): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess - </span></span>
<span><span class="co">#&gt; WARN [2026-02-04 18:29:50] estimate_truncation (chain: 2): Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess -</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="practical-workflow-for-prior-specification">Practical workflow for prior specification<a class="anchor" aria-label="anchor" href="#practical-workflow-for-prior-specification"></a>
</h2>
<div class="section level3">
<h3 id="step-1-start-with-defaults">Step 1: Start with defaults<a class="anchor" aria-label="anchor" href="#step-1-start-with-defaults"></a>
</h3>
<p>Always begin with default priors to check the model runs and produces
reasonable results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Minimal specification</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_infections.html">estimate_infections</a></span><span class="op">(</span></span>
<span>  <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu"><a href="../reference/generation_time_opts.html">gt_opts</a></span><span class="op">(</span><span class="va">example_generation_time</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">example_incubation_period</span> <span class="op">+</span> <span class="va">reporting_delay</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat</span></span>
<span><span class="co">#&gt; Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span><span class="co">#&gt; Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-identify-candidates-for-modification">Step 2: Identify candidates for modification<a class="anchor" aria-label="anchor" href="#step-2-identify-candidates-for-modification"></a>
</h3>
<p>Ask these questions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Do I have strong domain knowledge about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>?</strong>
→ Consider modifying <code>rt_opts(prior = ...)</code>
</li>
<li>
<strong>Does
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
change rapidly or gradually in my setting?</strong> → Consider modifying
<code>gp_opts(ls = ...)</code>
</li>
<li>
<strong>Is reporting highly variable or stable?</strong> → Consider
modifying <code>obs_opts(dispersion = ...)</code> or
<code>obs_opts(family = ...)</code>
</li>
<li>
<strong>Are there sudden policy changes?</strong> → Consider using
<code>rt_opts(rw = ...)</code> instead of GP</li>
<li>
<strong>Is recent data truncated?</strong> → Consider adding
<code>trunc_opts(...)</code>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="step-3-modify-one-prior-at-a-time">Step 3: Modify one prior at a time<a class="anchor" aria-label="anchor" href="#step-3-modify-one-prior-at-a-time"></a>
</h3>
<p>Make incremental changes and check sensitivity:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify R0 prior based on literature</span></span>
<span><span class="va">estimates_r0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_infections.html">estimate_infections</a></span><span class="op">(</span></span>
<span>  <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu"><a href="../reference/generation_time_opts.html">gt_opts</a></span><span class="op">(</span><span class="va">example_generation_time</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="../reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">example_incubation_period</span> <span class="op">+</span> <span class="va">reporting_delay</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="../reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2.5</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="va">stan</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The largest R-hat is NA, indicating chains have not mixed.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#r-hat</span></span>
<span><span class="co">#&gt; Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span><span class="co">#&gt; Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#tail-ess</span></span>
<span></span>
<span><span class="co"># Compare results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="prior_choice_guide-workflow-step3-1.png" alt="plot of chunk workflow-step3"><div class="figcaption">plot of chunk workflow-step3</div>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">estimates_r0</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="prior_choice_guide-workflow-step3-2.png" alt="plot of chunk workflow-step3"><div class="figcaption">plot of chunk workflow-step3</div>
</div>
</div>
<div class="section level3">
<h3 id="step-4-check-prior-predictive-distributions">Step 4: Check prior predictive distributions<a class="anchor" aria-label="anchor" href="#step-4-check-prior-predictive-distributions"></a>
</h3>
<p>It is good practice to check if your priors generate reasonable
trajectories before seeing data:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># You can visualise prior choices using EpiNow2's distribution objects</span></span>
<span><span class="va">prior_r0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Distributions.html">LogNormal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prior_r0</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="prior_choice_guide-workflow-step4-1.png" alt="plot of chunk workflow-step4"><div class="figcaption">plot of chunk workflow-step4</div>
</div>
<p>This shows the probability density of your prior. Check if this range
is sensible for your application. For example, does it put reasonable
mass on plausible
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
values for your pathogen?</p>
<p>Note: Full prior predictive checks (simulating complete epidemic
trajectories) require additional Stan code not currently exposed in
<a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a>, but visualising individual prior distributions
as shown above is a useful first step.</p>
</div>
<div class="section level3">
<h3 id="step-5-check-model-convergence">Step 5: Check model convergence<a class="anchor" aria-label="anchor" href="#step-5-check-model-convergence"></a>
</h3>
<p>After modifying priors, always check that the model has converged
properly. Poor prior choices can lead to convergence problems.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check convergence diagnostics</span></span>
<span><span class="co"># Extract the Stan fit object</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">estimates_r0</span><span class="op">$</span><span class="va">fit</span></span>
<span></span>
<span><span class="co"># Check Rhat (should be &lt; 1.01)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html" class="external-link">summarise_draws</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"rhat"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 511 × 2</span></span>
<span><span class="co">#&gt;    variable   rhat</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 params[1] 1.05 </span></span>
<span><span class="co">#&gt;  2 params[2] 1.01 </span></span>
<span><span class="co">#&gt;  3 params[3] 1.05 </span></span>
<span><span class="co">#&gt;  4 params[4] 1.01 </span></span>
<span><span class="co">#&gt;  5 eta[1]    1.06 </span></span>
<span><span class="co">#&gt;  6 eta[2]    1.03 </span></span>
<span><span class="co">#&gt;  7 eta[3]    0.999</span></span>
<span><span class="co">#&gt;  8 eta[4]    0.982</span></span>
<span><span class="co">#&gt;  9 eta[5]    1.02 </span></span>
<span><span class="co">#&gt; 10 eta[6]    1.03 </span></span>
<span><span class="co">#&gt; # ℹ 501 more rows</span></span>
<span></span>
<span><span class="co"># Check effective sample size (should be &gt; 400 for reliable inference)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html" class="external-link">summarise_draws</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"ess_bulk"</span>, <span class="st">"ess_tail"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The ESS has been capped to avoid unstable estimates.</span></span>
<span><span class="co">#&gt; Warning: The ESS has been capped to avoid unstable estimates.</span></span>
<span><span class="co">#&gt; # A tibble: 511 × 3</span></span>
<span><span class="co">#&gt;    variable  ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 params[1]    102.      85.9</span></span>
<span><span class="co">#&gt;  2 params[2]    112.      75.9</span></span>
<span><span class="co">#&gt;  3 params[3]     35.4     27.1</span></span>
<span><span class="co">#&gt;  4 params[4]     60.6    113. </span></span>
<span><span class="co">#&gt;  5 eta[1]       170.      54.6</span></span>
<span><span class="co">#&gt;  6 eta[2]       115.      77.8</span></span>
<span><span class="co">#&gt;  7 eta[3]       105.      71.9</span></span>
<span><span class="co">#&gt;  8 eta[4]       117.      81.2</span></span>
<span><span class="co">#&gt;  9 eta[5]        78.4     55.3</span></span>
<span><span class="co">#&gt; 10 eta[6]       130.     119. </span></span>
<span><span class="co">#&gt; # ℹ 501 more rows</span></span>
<span></span>
<span><span class="co"># You can also use the summary method which includes these diagnostics</span></span>
<span><span class="fu"><a href="../reference/summary.epinow.html">summary</a></span><span class="op">(</span><span class="va">estimates_r0</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         measure                estimate</span></span>
<span><span class="co">#&gt;                          &lt;char&gt;                  &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:       New infections per day     2125 (1306 -- 3337)</span></span>
<span><span class="co">#&gt; 2:   Expected change in reports       Likely decreasing</span></span>
<span><span class="co">#&gt; 3:   Effective reproduction no.      0.87 (0.67 -- 1.1)</span></span>
<span><span class="co">#&gt; 4:               Rate of growth -0.035 (-0.11 -- 0.024)</span></span>
<span><span class="co">#&gt; 5: Doubling/halving time (days)        -20 (29 -- -6.4)</span></span></code></pre></div>
<p>Key diagnostics to check:</p>
<ul>
<li>
<strong>Rhat</strong>: Should be &lt; 1.01 for all parameters.
Values &gt; 1.01 indicate chains have not converged.</li>
<li>
<strong>Effective sample size (ESS)</strong>: Bulk ESS and tail ESS
should both be &gt; 400. Low ESS means high autocorrelation and
unreliable estimates.</li>
<li>
<strong>Divergent transitions</strong>: Check for warnings about
divergences, which indicate problems with the posterior geometry.</li>
</ul>
<p>If you encounter convergence problems after changing priors,
consider:</p>
<ul>
<li>Making priors less informative (wider)</li>
<li>Checking that prior ranges are sensible (e.g., not excluding
plausible parameter values)</li>
<li>Increasing the number of warmup iterations or sampling
iterations</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="common-pitfalls-and-recommendations">Common pitfalls and recommendations<a class="anchor" aria-label="anchor" href="#common-pitfalls-and-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="pitfall-1-over-informative-priors-without-justification">Pitfall 1: Over-informative priors without justification<a class="anchor" aria-label="anchor" href="#pitfall-1-over-informative-priors-without-justification"></a>
</h3>
<p><strong>Problem:</strong> Setting very tight priors (small SD)
without strong external evidence.</p>
<p><strong>Solution:</strong> Use weakly informative priors unless you
have literature or prior data supporting tight priors. When in doubt,
make priors wider rather than tighter.</p>
</div>
<div class="section level3">
<h3 id="pitfall-2-ignoring-generation-time-and-delays">Pitfall 2: Ignoring generation time and delays<a class="anchor" aria-label="anchor" href="#pitfall-2-ignoring-generation-time-and-delays"></a>
</h3>
<p><strong>Problem:</strong> Using default <code><a href="../reference/generation_time_opts.html">gt_opts()</a></code> and
<code><a href="../reference/delay_opts.html">delay_opts()</a></code>, which assume 1-day generation time and no
delays.</p>
<p><strong>Solution:</strong> Always specify generation time and delays
from literature for your pathogen and data type.</p>
</div>
<div class="section level3">
<h3 id="pitfall-3-estimating-too-many-uncertain-parameters">Pitfall 3: Estimating too many uncertain parameters<a class="anchor" aria-label="anchor" href="#pitfall-3-estimating-too-many-uncertain-parameters"></a>
</h3>
<p><strong>Problem:</strong> Making generation time, delays, and scaling
all uncertain in a short time series.</p>
<p><strong>Solution:</strong> Prioritize fixed parameters from
literature. Only estimate parameters that are truly unknown and have
sufficient data (usually &gt;60 days) to identify them.</p>
</div>
<div class="section level3">
<h3 id="pitfall-4-wrong-time-scale-for-length-scale">Pitfall 4: Wrong time scale for length scale<a class="anchor" aria-label="anchor" href="#pitfall-4-wrong-time-scale-for-length-scale"></a>
</h3>
<p><strong>Problem:</strong> Setting GP length scale to 1-2 days,
expecting very flexible
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>.</p>
<p><strong>Solution:</strong> If you want daily flexibility, use a
random walk (<code>rt_opts(rw = 1)</code>) rather than GP with very
short length scale. GPs with length scale &lt;7 days often struggle.</p>
</div>
<div class="section level3">
<h3 id="pitfall-5-forgetting-the-max-parameter">Pitfall 5: Forgetting the max parameter<a class="anchor" aria-label="anchor" href="#pitfall-5-forgetting-the-max-parameter"></a>
</h3>
<p><strong>Problem:</strong> Not setting <code>max</code> on
distributions, leading to very long tails and slow computation.</p>
<p><strong>Solution:</strong> Always set sensible <code>max</code>
values for generation time and delays (e.g., <code>max = 14</code> or
<code>max = 20</code> for most respiratory diseases).</p>
</div>
</div>
<div class="section level2">
<h2 id="references-and-further-reading">References and further reading<a class="anchor" aria-label="anchor" href="#references-and-further-reading"></a>
</h2>
<ul>
<li>
<strong>Mathematical details</strong>: See <a href="estimate_infections.html">Model definition</a> vignette for full
equations and mathematical notation</li>
<li>
<strong>Gaussian Process details</strong>: See <a href="gaussian_process_implementation_details.html">Gaussian Process
implementation details</a> for GP mathematics</li>
<li>
<strong>Practical examples</strong>: See <a href="estimate_infections_options.html">Examples:
estimate_infections()</a> for code examples of different model
configurations</li>
<li>
<strong>Distribution interface</strong>: Run
<code><a href="../reference/Distributions.html">?EpiNow2::Distributions</a></code> for syntax of specifying
distributions</li>
</ul>
<div class="section level3">
<h3 id="key-papers">Key papers<a class="anchor" aria-label="anchor" href="#key-papers"></a>
</h3>
<p>For background on renewal equation models:</p>
<ul>
<li>Cori et al. (2013) on time-varying reproduction numbers: <a href="https://doi.org/10.1093/aje/kwt133" class="external-link">doi:10.1093/aje/kwt133</a>
</li>
<li>Riutort-Mayol et al. (2020) on approximate Gaussian processes in
Stan: <a href="https://arxiv.org/abs/2004.11408" class="external-link">arXiv:2004.11408</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Joel Hellewell, Katharine Sherratt, Katelyn Gostic, Joe Hickson, Hamada S. Badr, Michael DeWitt, James M. Azam, Adrian Lison, <a href="https://www.lshtm.ac.uk/aboutus/people/funk.sebastian" class="external-link">Sebastian Funk</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
