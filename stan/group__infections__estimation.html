<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiNow2 Stan Functions: Infections Estimation</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">EpiNow2 Stan Functions
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="topics.html"><span>Functions</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div class="header">
  <div class="summary">
<a href="#groups">Subgroups</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Infections Estimation</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for estimating infection trajectories.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Infections Estimation:</div>
<div class="dyncontent">
<div class="center"><img src="group__infections__estimation.png" border="0" usemap="#agroup____infections____estimation" alt=""/></div>
<map name="agroup____infections____estimation" id="agroup____infections____estimation">
<area shape="rect" href="group__estimates__smoothing.html" title="Functions for smoothing estimates using Gaussian processes." alt="" coords="196,5,340,31"/>
<area shape="rect" title="Functions for estimating infection trajectories." alt="" coords="5,31,148,56"/>
<area shape="rect" href="group__observation__model.html" title="Functions for modeling the observation process." alt="" coords="203,55,332,80"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Subgroups</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__estimates__smoothing.html">Estimates Smoothing</a></td></tr>
<tr class="memdesc:group__estimates__smoothing"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions for smoothing estimates using Gaussian processes. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__observation__model.html">Observation Model</a></td></tr>
<tr class="memdesc:group__observation__model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions for modeling the observation process. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2b1ee9503c17947f9516f55eeeb9046c" id="r_ga2b1ee9503c17947f9516f55eeeb9046c"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2b1ee9503c17947f9516f55eeeb9046c">update_infectiousness</a> (vector infections, vector gt_rev_pmf, int seeding_time, int index)</td></tr>
<tr class="separator:ga2b1ee9503c17947f9516f55eeeb9046c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad73c77fe949c016d439e0ac63ce1aa6a" id="r_gad73c77fe949c016d439e0ac63ce1aa6a"><td class="memItemLeft" align="right" valign="top">vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad73c77fe949c016d439e0ac63ce1aa6a">generate_infections</a> (vector R, int uot, vector gt_rev_pmf, array[] real initial_infections, int pop, int ht, int obs_scale, real frac_obs, int initial_as_scale)</td></tr>
<tr class="memdesc:gad73c77fe949c016d439e0ac63ce1aa6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate infections using a renewal equation approach.  <br /></td></tr>
<tr class="separator:gad73c77fe949c016d439e0ac63ce1aa6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacfe00b4587ada5fd900f2ec606cbf679" id="r_gacfe00b4587ada5fd900f2ec606cbf679"><td class="memItemLeft" align="right" valign="top">vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gacfe00b4587ada5fd900f2ec606cbf679">deconvolve_infections</a> (vector shifted_cases, vector noise, int fixed, int prior)</td></tr>
<tr class="separator:gacfe00b4587ada5fd900f2ec606cbf679"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>Functions for estimating infection trajectories. </p>
<p>This group contains functions for estimating and modeling infection dynamics, including implementation of the renewal equation and backcalculation approaches. Core infection estimation functions from <a class="el" href="infections_8stan.html">infections.stan</a> and related generated quantities functions. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gacfe00b4587ada5fd900f2ec606cbf679" name="gacfe00b4587ada5fd900f2ec606cbf679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacfe00b4587ada5fd900f2ec606cbf679">&#9670;&#160;</a></span>deconvolve_infections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector deconvolve_infections </td>
          <td>(</td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>shifted_cases</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>noise</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fixed</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>prior</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Backcalculate infections from cases</p>
<p>This function estimates infections by working backwards from observed cases, applying noise to account for uncertainty in the process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shifted_cases</td><td>Vector of shifted case counts </td></tr>
    <tr><td class="paramname">noise</td><td>Vector of noise values </td></tr>
    <tr><td class="paramname">fixed</td><td>Whether to use fixed (1) or variable (0) noise </td></tr>
    <tr><td class="paramname">prior</td><td>Prior type to use (0: noise only, 1: cases * noise, 2: random walk) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of infection counts </dd></dl>

<p class="definition">Definition at line <a class="el" href="infections_8stan_source.html#l00125">125</a> of file <a class="el" href="infections_8stan_source.html">infections.stan</a>.</p>

</div>
</div>
<a id="gad73c77fe949c016d439e0ac63ce1aa6a" name="gad73c77fe949c016d439e0ac63ce1aa6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad73c77fe949c016d439e0ac63ce1aa6a">&#9670;&#160;</a></span>generate_infections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector generate_infections </td>
          <td>(</td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>R</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>uot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>gt_rev_pmf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]real</td>          <td class="paramname"><span class="paramname"><em>initial_infections</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>pop</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ht</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>obs_scale</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real</td>          <td class="paramname"><span class="paramname"><em>frac_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>initial_as_scale</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate infections using a renewal equation approach. </p>
<p>This function implements the renewal equation to generate a time series of infections based on reproduction numbers and the generation time distribution. It can also account for population depletion if a population size is specified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">R</td><td>Vector of reproduction numbers </td></tr>
    <tr><td class="paramname">uot</td><td>Unobserved time (seeding time) </td></tr>
    <tr><td class="paramname">gt_rev_pmf</td><td>Vector of reversed generation time PMF </td></tr>
    <tr><td class="paramname">initial_infections</td><td>Array of initial infection values </td></tr>
    <tr><td class="paramname">pop</td><td>Initial susceptible population (0 for unlimited) </td></tr>
    <tr><td class="paramname">ht</td><td>Horizon time </td></tr>
    <tr><td class="paramname">obs_scale</td><td>Whether to scale by fraction observed (1) or not (0) </td></tr>
    <tr><td class="paramname">frac_obs</td><td>Fraction of infections that are observed </td></tr>
    <tr><td class="paramname">initial_as_scale</td><td>Whether initial infections are a scaling factor (1) or not (0) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of infection counts </dd></dl>

<p class="definition">Definition at line <a class="el" href="infections_8stan_source.html#l00063">63</a> of file <a class="el" href="infections_8stan_source.html">infections.stan</a>.</p>

<p class="reference">References <a class="el" href="rt_8stan_source.html#l00128">R_to_r()</a>, and <a class="el" href="infections_8stan_source.html#l00025">update_infectiousness()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__infections__estimation_gad73c77fe949c016d439e0ac63ce1aa6a_cgraph.png" border="0" usemap="#agroup__infections__estimation_gad73c77fe949c016d439e0ac63ce1aa6a_cgraph" alt=""/></div>
<map name="agroup__infections__estimation_gad73c77fe949c016d439e0ac63ce1aa6a_cgraph" id="agroup__infections__estimation_gad73c77fe949c016d439e0ac63ce1aa6a_cgraph">
<area shape="rect" title="Generate infections using a renewal equation approach." alt="" coords="5,31,140,56"/>
<area shape="rect" href="group__rt__estimation.html#gab6cc5437be69ba05ef8b5b6c10cbdf51" title=" " alt="" coords="234,5,293,31"/>
<area shape="poly" title=" " alt="" coords="140,32,218,21,219,27,141,37"/>
<area shape="rect" href="group__infections__estimation.html#ga2b1ee9503c17947f9516f55eeeb9046c" title=" " alt="" coords="188,55,339,80"/>
<area shape="poly" title=" " alt="" coords="141,49,172,53,172,59,140,55"/>
<area shape="rect" href="group__rt__estimation.html#ga7671592e7d61d662a76adbb129110826" title=" " alt="" coords="387,5,527,31"/>
<area shape="poly" title=" " alt="" coords="293,16,371,16,371,21,293,21"/>
</map>
</div>

</div>
</div>
<a id="ga2b1ee9503c17947f9516f55eeeb9046c" name="ga2b1ee9503c17947f9516f55eeeb9046c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2b1ee9503c17947f9516f55eeeb9046c">&#9670;&#160;</a></span>update_infectiousness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real update_infectiousness </td>
          <td>(</td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>infections</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>gt_rev_pmf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>seeding_time</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Infection Modeling Functions</p>
<p>This group of functions handles the generation, calculation, and backcalculation of infection time series in the model. These functions implement the core epidemiological dynamics, including the renewal equation approach. Calculate infectiousness for a single time point</p>
<p>This function computes the weighted sum of past infections with the generation time distribution to determine the current infectiousness.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infections</td><td>Vector of infection counts </td></tr>
    <tr><td class="paramname">gt_rev_pmf</td><td>Vector of reversed generation time PMF </td></tr>
    <tr><td class="paramname">seeding_time</td><td>Number of time steps used for seeding </td></tr>
    <tr><td class="paramname">index</td><td>Current time index (relative to seeding_time) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The infectiousness at the specified time point </dd></dl>

<p class="definition">Definition at line <a class="el" href="infections_8stan_source.html#l00025">25</a> of file <a class="el" href="infections_8stan_source.html">infections.stan</a>.</p>

<p class="reference">Referenced by <a class="el" href="generated__quantities_8stan_source.html#l00116">calculate_growth_infness()</a>, <a class="el" href="generated__quantities_8stan_source.html#l00021">calculate_Rt()</a>, and <a class="el" href="infections_8stan_source.html#l00063">generate_infections()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__infections__estimation_ga2b1ee9503c17947f9516f55eeeb9046c_icgraph.png" border="0" usemap="#agroup__infections__estimation_ga2b1ee9503c17947f9516f55eeeb9046c_icgraph" alt=""/></div>
<map name="agroup__infections__estimation_ga2b1ee9503c17947f9516f55eeeb9046c_icgraph" id="agroup__infections__estimation_ga2b1ee9503c17947f9516f55eeeb9046c_icgraph">
<area shape="rect" title=" " alt="" coords="389,55,540,80"/>
<area shape="rect" href="group__rt__estimation.html#gad5dfeda95f3acce7e217c7c47f13d0ee" title=" " alt="" coords="173,5,341,31"/>
<area shape="poly" title=" " alt="" coords="392,53,314,34,315,29,393,48"/>
<area shape="rect" href="group__rt__estimation.html#ga2d17e8b4b2a9d69dd576396d14b218e9" title=" " alt="" coords="210,55,304,80"/>
<area shape="poly" title=" " alt="" coords="373,70,304,70,304,65,373,65"/>
<area shape="rect" href="group__infections__estimation.html#gad73c77fe949c016d439e0ac63ce1aa6a" title="Generate infections using a renewal equation approach." alt="" coords="190,104,324,130"/>
<area shape="poly" title=" " alt="" coords="393,87,315,106,314,101,392,82"/>
<area shape="rect" href="group__rt__estimation.html#gaa4c10a0c2f7a164d5b6bf137dd7d2f7a" title=" " alt="" coords="5,5,125,31"/>
<area shape="poly" title=" " alt="" coords="157,21,125,21,125,16,157,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
