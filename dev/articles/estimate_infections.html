<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Model definition: estimate_infections() • EpiNow2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model definition: estimate_infections()">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiNow2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.8.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/EpiNow2.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reference" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reference</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reference">
<li><a class="dropdown-item" href="../reference/index.html">R Reference</a></li>
    <li><a class="dropdown-item" href="https://epiforecasts.io/EpiNow2/stan/">Stan Reference</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-model-definitions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Model definitions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-model-definitions">
<li><a class="dropdown-item" href="../articles/estimate_infections.html">estimate_infections()</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_secondary.html">estimate_secondary()</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_truncation.html">estimate_truncation()</a></li>
    <li><a class="dropdown-item" href="../articles/gaussian_process_implementation_details.html">Gaussian Process implementation details</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-usage" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Usage</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-usage">
<li><a class="dropdown-item" href="../articles/estimate_infections_workflow.html">Workflow for Rt estimation and forecasting</a></li>
    <li><a class="dropdown-item" href="../articles/prior_choice_guide.html">Prior choice and specification guide</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_infections_options.html">Examples: estimate_infections()</a></li>
    <li><a class="dropdown-item" href="../articles/epinow.html">Using epinow() for running in production mode</a></li>
    <li><a class="dropdown-item" href="../articles/forecasting_multiple_data_streams.html">Forecasting multiple data streams</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><a class="dropdown-item" href="../articles/case-studies.html">External case studies and use in the literature</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiforecasts/EpiNow2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model definition: estimate_infections()</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/EpiNow2/blob/main/vignettes/estimate_infections.Rmd" class="external-link"><code>vignettes/estimate_infections.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_infections.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="infection-model">Infection model<a class="anchor" aria-label="anchor" href="#infection-model"></a>
</h2>
<p><code><a href="../reference/estimate_infections.html">estimate_infections()</a></code> supports a range of model
formulations. Here we describe the most commonly used and highlight
other options. The two main models for how new infections arise in the
model are a <em>renewal equation model</em> and a <em>non-mechanistic
infection model</em>. The initialisation of both of these models
involves estimating an initial infection trajectory during a
<code>seeding_time</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub><annotation encoding="application/x-tex">t_\mathrm{seed}</annotation></semantics></math>
(set to the mean of modelled delays from infection to observation) that
precedes the first observation at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="renewal-equation-model">Renewal equation model<a class="anchor" aria-label="anchor" href="#renewal-equation-model"></a>
</h3>
<p>This is the default model and is used when <code>rt != NULL</code>.
New infections are generated at discrete time steps of one day via the
renewal equation<span class="citation"><sup>[1]</sup></span>. These
infections are then mapped to observations via discrete convolutions
with delay distributions.</p>
<div class="section level4">
<h4 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h4>
<p>The model is initialised before the first observed data point by
assuming constant exponential growth for the mean of modelled delays
from infection to case report (called <code>seeding_time</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub><annotation encoding="application/x-tex">t_\mathrm{seed}</annotation></semantics></math>
in the model):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mo>−</mo><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mi>ξ</mi></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ι</mi><mo>−</mo><mi>r</mi><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>ι</mi></mtd><mtd columnalign="right" style="text-align: right"><mo>∼</mo><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ι</mi><mn>0</mn></msub><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>ι</mi><mn>0</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  I_{-t_\mathrm{seed}} &amp;= \frac{1}{\xi} \exp(\iota - r t_\mathrm{seed})
  \iota &amp; \sim \mathrm{Normal}(\iota_0, 2)\\
  \iota_0 &amp; = \max(0, \log(C_\mathrm{init}))
\end{align}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>t</mi></msub><annotation encoding="application/x-tex">I_{t}</annotation></semantics></math>
is the number of latent infections on day
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is an estimate of the initial growth rate,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
is the proportion reported (see <a href="#delays-and-scaling">Delays and
scaling</a>), is a scaling factor and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow></msub><annotation encoding="application/x-tex">C_\mathrm{init}</annotation></semantics></math>
is the mean of the first 7 days of cases (or all cases if fewer than 7
days of data are available).</p>
<p>The initial growth rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is estimated from the first estimated value of the reproduction number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
by solving the linear system [wallinga2006how]</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>1</mn><mi>/</mi><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
M(-r) - 1 / R_0 = 0.
</annotation></semantics></math></p>
<p>where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>g</mi><mi>i</mi></msub><msup><mi>e</mi><mrow><mi>r</mi><mi>i</mi></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
M(r) = \sum_{i=1}^n g_i e^{r i}.
</annotation></semantics></math></p>
<p>is the moment generating function of the discretised generation time
distribution (see <a href="#infections">Infections</a>).</p>
</div>
<div class="section level4">
<h4 id="infections">Infections<a class="anchor" aria-label="anchor" href="#infections"></a>
</h4>
<p>For the time window of the observed data and beyond infections are
then modelled by weighting previous infections with the generation time
and scaling by the instantaneous reproduction number:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><munderover><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>g</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></msub></munderover><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>I</mi><mrow><mi>t</mi><mo>−</mo><mi>τ</mi></mrow></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><msub><mi>λ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  I_t = R_t \sum_{\tau = 1}^{g_\mathrm{max}} g(\tau | \theta_g) I_{t - \tau} = R_t \lambda_t
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>τ</mi></msub><mo>=</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_\tau = g(\tau | \theta_g)</annotation></semantics></math>
is the discretised distribution of generation times with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>g</mi></msub><annotation encoding="application/x-tex">\theta_g</annotation></semantics></math>
and maximum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></msub><annotation encoding="application/x-tex">g_\mathrm{max}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>t</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>g</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></msub></msubsup><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>I</mi><mrow><mi>t</mi><mo>−</mo><mi>τ</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_t = \sum_{\tau = 1}^{g_\mathrm{max}} g(\tau | \theta_g) I_{t - \tau}</annotation></semantics></math>
is the total infectiousness at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
Generation times can be specified as coming from a distribution with
uncertainty by giving mean and standard deviations of normal priors of
the distributional parameters. By default this prior is weighted by
default by the number of observations although this can be changed by
the user. It is truncated to be positive where relevant for the given
distribution. Alternatively, generation times can be specified as coming
from a given distribution with set parameters.</p>
<p>The distribution of generation times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
here represents the probability that somebody who became infectious on
day 0 and who infects someone else during their course of infection does
so on day
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\tau &gt; 0</annotation></semantics></math>,
assuming that infection cannot happen on day 0. If not given this
defaults to a fixed generation time of 1, in which case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_{t}</annotation></semantics></math>
represents the exponential of the daily growth rate of infections.</p>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number">Time-varying reproduction number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number"></a>
</h4>
<p>Different options are available for setting a prior for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>,
the instantaneous reproduction number at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
The default prior is an approximate zero-mean Gaussian Process (GP) for
the first differences in time on the log scale,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><mo>log</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∼</mo><msub><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  \log R_{t} - \log R_{t-1} \sim \mathrm{GP}_t
\end{equation}</annotation></semantics></math></p>
<p>More details on the mathematical form of the GP approximation and
implementation are given in the <a href="gaussian_process_implementation_details.html">Gaussian Process
implementation details</a> vignette. Other choices for the prior of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
are available such as a GP prior for the difference between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
and its mean value (implying that in the absence of data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
will revert to its prior mean rather than the last value with robust
support from the data).</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><mo>log</mo><msub><mi>R</mi><mn>0</mn></msub><mo>∼</mo><msub><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  \log R_{t} - \log R_0 \sim \mathrm{GP}_t
\end{equation}</annotation></semantics></math></p>
<p>or, as a specific case of a Gaussian Process, a random walk of
arbitrary length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mo>log</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>÷</mo><mi>w</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>÷</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>,</mo><msub><mi>σ</mi><mi>R</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mi>R</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \log R_{t \div w} &amp;\sim \mathrm{Normal} (R_{t \div (w - 1)}, \sigma_R)\\
  \sigma_R &amp;\sim \mathrm{HalfNormal}(0, 0.1)
\end{align}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>÷</mo><annotation encoding="application/x-tex">\div</annotation></semantics></math>
indicates interval-valued division (i.e. the floor of the division),
such that for example
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w=1</annotation></semantics></math>
indicates a daily and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">w=7</annotation></semantics></math>
a weekly random walk.</p>
<p>The choice of prior for the time-varying reproduction number impact
run-time, smoothness of the estimates and real-time behaviour and may
alter the best use-case for the model.</p>
<p>The prior distribution of the initial reproduction number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_{0}</annotation></semantics></math>
can be set by the user. By default this is a log-normal distribution
with mean 1 and standard deviation 1.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>∼</mo><mrow><mi mathvariant="normal">L</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msqrt><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
  R_0 \sim \mathrm{LogNormal}(-1/2 \log(2), \sqrt{\log(2)})
\end{equation}</annotation></semantics></math></p>
<p>The simplest possible process model option is to use no time-varying
prior and rely on just the intial fixed reproduction number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="beyond-the-end-of-the-observation-period">Beyond the end of the observation period<a class="anchor" aria-label="anchor" href="#beyond-the-end-of-the-observation-period"></a>
</h4>
<p>Beyond the end of the observation period
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>),
by default, the Gaussian process is assumed to continue. However, here
again there are a range of options. These include fixing transmission
dynamics (optionally this can also be done before the end of the
observation period), and adjusting for depletion of the susceptible
population.</p>
</div>
<div class="section level4">
<h4 id="adjusting-for-susceptible-population-depletion">Adjusting for susceptible population depletion<a class="anchor" aria-label="anchor" href="#adjusting-for-susceptible-population-depletion"></a>
</h4>
<p>The model can account for the depletion of susceptible individuals
over time, which reduces transmission potential even if the intrinsic
reproduction number remains constant. This is controlled via the
<code>pop</code>, <code>pop_period</code>, and <code>pop_floor</code>
parameters in <code><a href="../reference/rt_opts.html">rt_opts()</a></code>.</p>
<p>When a population size is specified (via the <code>pop</code>
parameter), the model adjusts both infections and the reproduction
number estimates to account for susceptible depletion. The adjustment
uses the following formula for infections:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub><mo>=</mo><msub><mi>S</mi><mi>t</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mo>−</mo><msub><mi>R</mi><mi>t</mi></msub><msub><mi>λ</mi><mi>t</mi></msub></mrow><msub><mi>S</mi><mi>t</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
    I_t = S_t \left(1 - \exp \left(\frac{-R_t \lambda_t}{S_t}\right)\right),
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mtext mathvariant="normal">floor</mtext></msub><mo>,</mo><mi>N</mi><mo>−</mo><msubsup><mi>I</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mi>c</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_t = \max(N_{\text{floor}}, N - I^c_{t-1})</annotation></semantics></math>
is the susceptible population at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
is the initial population size,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>I</mi><mi>t</mi><mi>c</mi></msubsup><mo>=</mo><msub><mo>∑</mo><mrow><mi>s</mi><mo>&lt;</mo><mi>t</mi></mrow></msub><msub><mi>I</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">I^c_t = \sum_{s&lt; t} I_s</annotation></semantics></math>
are cumulative infections by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>
is the unadjusted reproduction number, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\lambda_t</annotation></semantics></math>
is the total infectiousness. The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mtext mathvariant="normal">floor</mtext></msub><annotation encoding="application/x-tex">N_{\text{floor}}</annotation></semantics></math>
(controlled by <code>pop_floor</code>, default 1.0) provides a numerical
stability floor and can be interpreted as representing ongoing
importation.</p>
<p>The adjustment can be applied in two ways, controlled by the
<code>pop_period</code> parameter: - <code>"forecast"</code> (default):
adjustment applied only to forecasts beyond the observation period -
<code>"all"</code>: adjustment applied to both the observation period
and forecasts</p>
<p>When population adjustment is enabled, the returned reproduction
number estimates (<code>R</code>) are back-calculated from the adjusted
infections to reflect the effective reproduction occurring given the
current susceptible population:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>t</mi><mtext mathvariant="normal">adjusted</mtext></msubsup><mo>=</mo><mfrac><msub><mi>I</mi><mi>t</mi></msub><msub><mi>λ</mi><mi>t</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
    R^{\text{adjusted}}_t = \frac{I_t}{\lambda_t}
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>t</mi></msub><annotation encoding="application/x-tex">I_t</annotation></semantics></math>
are the adjusted infections and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\lambda_t</annotation></semantics></math>
is the total infectiousness. This gives an effective reproduction number
that is consistent with the infection dynamics. The unadjusted
reproduction number (representing transmission in a fully susceptible
population) is also returned as <code>R_unadjusted</code> for reference.
This adjustment approach is based on the one implemented in the
<code>epidemia</code> R package<span class="citation"><sup>[2]</sup></span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="non-mechanistic-infection-model">Non-Mechanistic infection model<a class="anchor" aria-label="anchor" href="#non-mechanistic-infection-model"></a>
</h3>
<p>This is an alternative model that can be used by setting
<code>rt = NULL</code> that assumes less epidemiological mechanism by
directly modelling infections on a log scale with a range of process
models. By default, this uses a Gaussian Process prior for the number of
new infections each day (on the log scale) although alternatively
infections can be estimated using a prior based on a fixed backwards
mapping of observed cases. In general, these model options will be more
computationally efficient than the renewal process model but may be less
robust due to the lack of an epidemiological process model (i.e. more
dependence is placed on the assumptions of the Gaussian process
prior).</p>
<div class="section level4">
<h4 id="initialisation-1">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation-1"></a>
</h4>
<p>In order to initialise this model, an initial estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></mrow></msub><annotation encoding="application/x-tex">I_\mathrm{est}</annotation></semantics></math>
of the infection trajectory is first created by first shifting
observations back in time by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub><annotation encoding="application/x-tex">t_\mathrm{seed}</annotation></semantics></math>
and then smoothing the observation data with a moving average of window
size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
(default:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mn>14</mn></mrow><annotation encoding="application/x-tex">z=14</annotation></semantics></math>),
allocated to the centre of the window:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></mrow><mo>,</mo><mi>t</mi><mo>&lt;</mo><mi>T</mi><mo>−</mo><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mi>z</mi></mfrac><munderover><mo>∑</mo><mrow><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub><mo>,</mo><mi>t</mi><mo>−</mo><mi>z</mi><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">s</mi></mrow></msub><mo>,</mo><mi>t</mi><mo>+</mo><mi>z</mi><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></munderover><msub><mi>I</mi><mrow><mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">s</mi></mrow><mo>,</mo><mi>t</mi><mo>+</mo><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  I_{\mathrm{est}, t \lt T - t_\mathrm{seed}} = \frac{1}{z} \sum_{\max(-t_\mathrm{seed}, t - z/2)}^{\min(t_\mathrm{obs}, t + z/2)} I_{\mathrm{obs}, t + t_\mathrm{seed}}
\end{align}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the day of the last observation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">z/2</annotation></semantics></math>
is rounded up to the nearest integer in the limits of the sum, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">s</mi><mo mathvariant="normal">,</mo><mi mathvariant="normal">t</mi><mo mathvariant="normal">&lt;</mo><mn mathvariant="normal">0</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">I_\mathrm{obs, t \lt 0} = 0</annotation></semantics></math>.
Any date with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></mrow><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">I_{\mathrm{est}, t} = 0</annotation></semantics></math>
cases following this procedure is then allocated 1 case to facilitate
further processing in the model.</p>
<p>For any times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mi>T</mi><mo>−</mo><msub><mi>t</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t &gt; T - t_\mathrm{seed}</annotation></semantics></math>
the number of infections is then estimated by fitting an exponential
curve to the final week of data and extrapolating this until the end of
the forecast horizon.</p>
</div>
<div class="section level4">
<h4 id="infections-1">Infections<a class="anchor" aria-label="anchor" href="#infections-1"></a>
</h4>
<p>By default, a Gaussian Process prior is used for the number of
infections, resulting in smoother estimates of the infection curve. In
this case, as in the renewal equation model there are two alternative
formulations available. The default uses an approximate zero-mean GP for
the differences between modelled infections and the initial
estimate,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>I</mi><mi>t</mi></msub><mo>−</mo><mo>log</mo><msub><mi>I</mi><mrow><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></mrow><mo>,</mo><mi>t</mi></mrow></msub><mo>∼</mo><msub><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  \log I_{t} - \log I_{\mathrm{est}, t} \sim \mathrm{GP}_t
\end{equation}</annotation></semantics></math></p>
<p>Alternatively, one can use is an approximate zero-mean Gaussian
Process (GP) for the first differences in time on the log scale,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>I</mi><mi>t</mi></msub><mo>−</mo><mo>log</mo><msub><mi>I</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∼</mo><msub><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  \log I_{t} - \log I_{t-1} \sim \mathrm{GP}_t
\end{equation}</annotation></semantics></math></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>I</mi><mn>0</mn></msub><mo>−</mo><mo>log</mo><msub><mi>I</mi><mrow><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></mrow><mo>,</mo><mn>0</mn></mrow></msub><mo>∼</mo><msub><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi></mrow><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\log I_{0} - \log I_{\mathrm{est}, 0} \sim \mathrm{GP}_{0}</annotation></semantics></math></p>
<p>More details on the mathematical form of the Gaussian process
approximation are given in the <a href="gaussian_process_implementation_details.html">Gaussian Process
implementation details</a> vignette.</p>
<p>As for the renewal equation model, the Gaussian process can be
replaced by a random walk of arbitrary length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>.</p>
<p>When using a fixed shift from infections to reported cases there is
no process model and so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></mrow></msub><annotation encoding="application/x-tex">I_\mathrm{est}</annotation></semantics></math>
is used as the estimated infection curve (potentially scaled to take
into account underreporting, see section <a href="#delays-and-scaling">Delays and scaling</a>).</p>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number-1">Time-varying reproduction number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number-1"></a>
</h4>
<p>In this model there is no prior on the time-varying reproduction
number. Instead, this is calculated from the renewal equation as a
post-processing step</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><mfrac><msub><mi>I</mi><mi>t</mi></msub><mrow><munderover><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>g</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></msub></munderover><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mi>g</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>I</mi><mrow><mi>t</mi><mo>−</mo><mi>τ</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
  R_t = \frac{I_{t}}{\sum_{\tau = 1}^{g_\mathrm{max}} g(\tau | \mu_{g}, \sigma_{g}) I_{t - \tau}}
\end{equation}</annotation></semantics></math></p>
<p>and optionally smoothed using a centred rolling mean with a window
size that can be set by the user.</p>
</div>
<div class="section level4">
<h4 id="beyond-the-end-of-the-observation-period-1">Beyond the end of the observation period<a class="anchor" aria-label="anchor" href="#beyond-the-end-of-the-observation-period-1"></a>
</h4>
<p>Beyond the end of the observation period, by default, if using a
Gaussian process it is assumed to continue. Alternatively, incidence can
be fixed at ether the estimate at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
or a less recent, more certain estimate.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="delays-and-scaling">Delays and scaling<a class="anchor" aria-label="anchor" href="#delays-and-scaling"></a>
</h2>
<p>If infections are observed with a delay (for example, the incubation
period if based on symptomatic cases, and any delay from onset to
report), they are convolved in the model to infections at the time scale
of observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>t</mi></msub><annotation encoding="application/x-tex">D_{t}</annotation></semantics></math>
using delay distributions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>,
scaled by an underreporting factor $(which is 1 if all infections are
observed). This model can be defined mathematically as follows,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub><mo>=</mo><mi>ξ</mi><munderover><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mn>0</mn></mrow><msub><mi>ξ</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></msub></munderover><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mi>ξ</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>ξ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>I</mi><mrow><mi>t</mi><mo>−</mo><mi>τ</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  D_t = \xi \sum_{\tau = 0}^{\xi_\mathrm{max}} \xi (\tau | \mu_{\xi}, \sigma_{\xi}) I_{t-\tau}
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mi>τ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi(\tau| \theta_\tau)</annotation></semantics></math>
is the combined discrete distribution of delays with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>ξ</mi></msub><annotation encoding="application/x-tex">\theta_\xi</annotation></semantics></math>
and maximum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></msub><annotation encoding="application/x-tex">\xi_\mathrm{max}</annotation></semantics></math>.</p>
<p>Delays can either be specified as coming from a distribution with
uncertainty by giving mean and standard deviations of normal priors for
the distributional parameters, weighted by default by the number of
observations and truncated to be positive where relevant for the given
distribution; or they can be specified as coming from a distribution
with given parameters, or as fixed values.</p>
<p>The scaling factor $represents the proportion of cases that are
ultimately reported, which by default is set to 1 (i.e. no
underreporting) but can instead be estimated with a given prior
distribution.</p>
</div>
<div class="section level2">
<h2 id="observation-model">Observation model<a class="anchor" aria-label="anchor" href="#observation-model"></a>
</h2>
<p>The modelled counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>t</mi></msub><annotation encoding="application/x-tex">D_{t}</annotation></semantics></math>
are related to observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>t</mi></msub><annotation encoding="application/x-tex">C_{t}</annotation></semantics></math>.
By default this is assumed to follow a negative binomial distribution
with overdispersion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>φ</mi><annotation encoding="application/x-tex">\varphi</annotation></semantics></math>
(alternatively it can be modelled as a Poisson, in which case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>φ</mi><annotation encoding="application/x-tex">\varphi</annotation></semantics></math>
is not used):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>C</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">B</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ω</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mrow><mspace width="0.444em"></mspace><mo>mod</mo><mspace width="0.222em"></mspace><msub><mi>n</mi><mi>ω</mi></msub></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msub><msub><mi>D</mi><mi>t</mi></msub><mo>,</mo><mi>φ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  C_t &amp;\sim \mathrm{NegBinom}\left(\omega_{(t \mod n_\omega)}D_t, \varphi\right)
\end{align}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ω</mi><mrow><mi>t</mi><mrow><mspace width="0.444em"></mspace><mo>mod</mo><mspace width="0.222em"></mspace><msub><mi>n</mi><mi>ω</mi></msub></mrow></mrow></msub><annotation encoding="application/x-tex">\omega_{t \mod n_\omega}</annotation></semantics></math>
is a daily reporting effect of cyclicity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>ω</mi></msub><annotation encoding="application/x-tex">n_{\omega}</annotation></semantics></math>.
If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>ω</mi></msub><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">n_{\omega}=7</annotation></semantics></math>
this corresponds to a day-of-the-week reporting effect.</p>
<p>In the model overdispersion is characterised by a “dispersion”
parameter, which is defined as one over the square root of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mi>p</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">varphi</annotation></semantics></math>.
With this, the priors for the observation model are</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mi>ω</mi><msub><mi>n</mi><mi>ω</mi></msub></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mn>1</mn><msqrt><mi>φ</mi></msqrt></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    \frac{\omega}{n_\omega} &amp;\sim \mathrm{Dirichlet}(1, \ldots, 1) \\
    \frac{1}{\sqrt{\varphi}} &amp;\sim \mathrm{HalfNormal}(0, 1)
\end{align}</annotation></semantics></math></p>
<div class="section level3">
<h3 id="truncation">Truncation<a class="anchor" aria-label="anchor" href="#truncation"></a>
</h3>
<p>The model supports counts that are right-truncated, i.e. reported
with a delay leading to recent counts being subject to future upwards
revision. Denoting the final truncated counts with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>D</mi><mi>t</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">D^{\ast}_{t}</annotation></semantics></math>
they are obtained form the final modelled cases
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>t</mi></msub><annotation encoding="application/x-tex">D_{t}</annotation></semantics></math>
by applying a given discrete truncation distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ζ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mi>ζ</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>ζ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\zeta(\tau | \mu_{\zeta}, \sigma_{\zeta})</annotation></semantics></math>
with cumulative mass function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mi>ζ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z(\tau | \mu_{\zeta})</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>D</mi><mi>t</mi><mo>*</mo></msubsup><mo>=</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>−</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mi>Z</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>Z</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  D^\ast_t = Z(T - t | \mu_{Z}, \sigma_{Z}) D_{t}
\end{equation}</annotation></semantics></math></p>
<p>If truncation is applied, the modelled cases
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>t</mi></msub><annotation encoding="application/x-tex">D_{t}</annotation></semantics></math>
are replaced by the truncated counts before confronting them with
observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>t</mi></msub><annotation encoding="application/x-tex">C_{t}</annotation></semantics></math>
as described above.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" entry-spacing="0" line-spacing="2">
<div id="ref-renewal" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Fraser, C. (2007). Estimating individual and
household reproduction numbers in an emerging epidemic. <em>PLOS
ONE</em>, <em>2</em>(8), 1–12. <a href="https://doi.org/10.1371/journal.pone.0000758" class="external-link">https://doi.org/10.1371/journal.pone.0000758</a>
</div>
</div>
<div id="ref-bhattSemiMechanisticBayesianModeling" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Bhatt, S., Ferguson, N., Flaxman, S., Gandy,
A., Mishra, S., &amp; Scott, J. A. (n.d.). <em>Semi-<span>Mechanistic
Bayesian</span> modeling of <span>COVID-19</span> with <span>Renewal
Processes</span></em>. 14.</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Joel Hellewell, Katharine Sherratt, Katelyn Gostic, Joe Hickson, Hamada S. Badr, Michael DeWitt, James M. Azam, Adrian Lison, <a href="https://www.lshtm.ac.uk/aboutus/people/funk.sebastian" class="external-link">Sebastian Funk</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
