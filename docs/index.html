<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Realtime Case Counts and Time-varying Epidemiological Parameters  â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Realtime Case Counts and Time-varying Epidemiological Parameters ">
<meta property="og:description" content="To identify changes in the reproduction number, rate of spread, 
             and doubling time during the course of outbreaks whilst accounting 
             for potential biases due to delays in case reporting.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate realtime case counts and time-varying epidemiological parameters</h1></div>

<p><em>This package is under development.</em></p>
<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools and current best practices. It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development. It assumes that only limited data is available on cases by date of onset and instead uses cases by date of report. These are then imputed to case counts by date of infection using an uncertain reporting delay and incubation period via a Gaussian process based method. Right truncation of cases is dealt with internally by <code>{EpiNow2}</code>, as is propagating uncertainty from all inputs into the final parameter estimates (helping to mitigate spurious findings). Time-varying estimates of the reproduction number are estimated using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a> package by date of infection with a generation time estimate that includes uncertainty and variation over time controlled using a Gaussian process. Time-varying estimates of the rate of growth are derived from the time-varying reproduction estimates and the uncertain generation time. Optionally, the time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process. See the <a href="https://epiforecasts.io/covid/methods.html">methods</a> section of our Covid-19 site for a detailed discussion of the approach.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw pkg">drat</span><span class="kw ns">:::</span><span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)</pre></div>
<p>Install the development version of the package with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underyling infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence).</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">reporting_delay</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="no">reporting_delay</span>$<span class="no">max</span> <span class="kw">&lt;-</span> <span class="fl">30</span>

<span class="no">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.412243</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1499645</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.066485</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1264387</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span></pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">generation_time</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                        <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                         <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                         <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                         <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)

<span class="no">incubation_period</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                          <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                          <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                          <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                          <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span>:<span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span></pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/epinow.html">epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                             <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                             <span class="kw">incubation_period</span> <span class="kw">=</span> <span class="no">incubation_period</span>,
                             <span class="kw">reporting_delay</span> <span class="kw">=</span> <span class="no">reporting_delay</span>,
                             <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>,
                             <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                             <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span></pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">estimates</span>$<span class="no">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;           variable          parameter time       date sample     value strat</span>
<span class="co">#&gt;      1: infections imputed_infections    1 2020-02-13      1  3.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      2: infections imputed_infections    2 2020-02-14      1  8.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      3: infections imputed_infections    3 2020-02-15      1 15.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      4: infections imputed_infections    4 2020-02-16      1 23.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      5: infections imputed_infections    5 2020-02-17      1 52.000000  &lt;NA&gt;</span>
<span class="co">#&gt;     ---                                                                     </span>
<span class="co">#&gt; 125062:      gt_sd              gt_sd   NA       &lt;NA&gt;    496  3.349294  &lt;NA&gt;</span>
<span class="co">#&gt; 125063:      gt_sd              gt_sd   NA       &lt;NA&gt;    497  3.125498  &lt;NA&gt;</span>
<span class="co">#&gt; 125064:      gt_sd              gt_sd   NA       &lt;NA&gt;    498  2.982192  &lt;NA&gt;</span>
<span class="co">#&gt; 125065:      gt_sd              gt_sd   NA       &lt;NA&gt;    499  3.222913  &lt;NA&gt;</span>
<span class="co">#&gt; 125066:      gt_sd              gt_sd   NA       &lt;NA&gt;    500  3.087543  &lt;NA&gt;</span>
<span class="co">#&gt;             type</span>
<span class="co">#&gt;      1: estimate</span>
<span class="co">#&gt;      2: estimate</span>
<span class="co">#&gt;      3: estimate</span>
<span class="co">#&gt;      4: estimate</span>
<span class="co">#&gt;      5: estimate</span>
<span class="co">#&gt;     ---         </span>
<span class="co">#&gt; 125062:     &lt;NA&gt;</span>
<span class="co">#&gt; 125063:     &lt;NA&gt;</span>
<span class="co">#&gt; 125064:     &lt;NA&gt;</span>
<span class="co">#&gt; 125065:     &lt;NA&gt;</span>
<span class="co">#&gt; 125066:     &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type      bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate    2.080170    3.081025</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate    2.143199    2.905762</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate    2.179430    2.734900</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate    2.140953    2.581655</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate    2.103074    2.531589</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 312: 2020-04-14 reported_cases  &lt;NA&gt; forecast 1193.000000 5825.000000</span>
<span class="co">#&gt; 313: 2020-04-15 reported_cases  &lt;NA&gt; forecast 1027.000000 5071.000000</span>
<span class="co">#&gt; 314: 2020-04-16 reported_cases  &lt;NA&gt; forecast 1031.000000 5688.000000</span>
<span class="co">#&gt; 315: 2020-04-17 reported_cases  &lt;NA&gt; forecast 1050.000000 7226.000000</span>
<span class="co">#&gt; 316: 2020-04-18 reported_cases  &lt;NA&gt; forecast  795.000000 6704.000000</span>
<span class="co">#&gt;            lower       upper      median        mean           sd</span>
<span class="co">#&gt;   1:    2.248587    2.640735    2.511794    2.538888    0.3283498</span>
<span class="co">#&gt;   2:    2.293238    2.586494    2.469596    2.486334    0.2376237</span>
<span class="co">#&gt;   3:    2.272625    2.491991    2.415992    2.427609    0.1723544</span>
<span class="co">#&gt;   4:    2.258612    2.432302    2.355863    2.362968    0.1377549</span>
<span class="co">#&gt;   5:    2.180699    2.343227    2.285555    2.293454    0.1307411</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 312: 2150.000000 3863.000000 3220.000000 3575.986000 1628.9503652</span>
<span class="co">#&gt; 313: 1479.000000 2984.000000 2684.500000 3019.954000 1695.1303341</span>
<span class="co">#&gt; 314: 1766.000000 3428.000000 2859.500000 3358.774000 2274.8845417</span>
<span class="co">#&gt; 315: 2328.000000 4590.000000 3489.000000 4161.508000 2682.2294263</span>
<span class="co">#&gt; 316: 1414.000000 3247.000000 2836.000000 3871.282000 4764.5249049</span></pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">estimates</span>$<span class="no">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;        sample       date cases</span>
<span class="co">#&gt;     1:      1 2020-02-16     2</span>
<span class="co">#&gt;     2:      1 2020-02-17     1</span>
<span class="co">#&gt;     3:      1 2020-02-18     4</span>
<span class="co">#&gt;     4:      1 2020-02-19     4</span>
<span class="co">#&gt;     5:      1 2020-02-20    14</span>
<span class="co">#&gt;    ---                        </span>
<span class="co">#&gt; 28005:    500 2020-04-07  3849</span>
<span class="co">#&gt; 28006:    500 2020-04-08  3873</span>
<span class="co">#&gt; 28007:    500 2020-04-09  3770</span>
<span class="co">#&gt; 28008:    500 2020-04-10  3562</span>
<span class="co">#&gt; 28009:    500 2020-04-11  3475</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date bottom  top lower upper median        mean          sd</span>
<span class="co">#&gt;  1: 2020-02-13      1    1     1     1    1.0    1.000000   0.0000000</span>
<span class="co">#&gt;  2: 2020-02-14      1    1     1     1    1.0    0.968750   0.1767767</span>
<span class="co">#&gt;  3: 2020-02-15      0    2     1     1    1.0    0.993007   0.6108929</span>
<span class="co">#&gt;  4: 2020-02-16      0    2     1     1    1.0    1.344633   0.8809517</span>
<span class="co">#&gt;  5: 2020-02-17      0    4     1     2    2.0    2.353556   1.5494971</span>
<span class="co">#&gt;  6: 2020-02-18      1    8     3     5    4.0    4.632000   2.3098153</span>
<span class="co">#&gt;  7: 2020-02-19      4   13     6     9    8.0    7.918000   3.0656275</span>
<span class="co">#&gt;  8: 2020-02-20      5   18     9    14   12.0   12.776000   4.1742872</span>
<span class="co">#&gt;  9: 2020-02-21     10   27    13    20   19.0   19.710000   5.4916497</span>
<span class="co">#&gt; 10: 2020-02-22     18   39    20    29   28.0   28.310000   6.6644377</span>
<span class="co">#&gt; 11: 2020-02-23     28   52    32    41   39.0   39.884000   7.8092582</span>
<span class="co">#&gt; 12: 2020-02-24     39   70    47    59   55.0   55.514000   9.5179297</span>
<span class="co">#&gt; 13: 2020-02-25     54   93    62    78   73.0   74.436000  12.3927828</span>
<span class="co">#&gt; 14: 2020-02-26     71  122    91   111   98.0   99.462000  16.4743243</span>
<span class="co">#&gt; 15: 2020-02-27     98  161   115   141  129.0  130.686000  20.9837088</span>
<span class="co">#&gt; 16: 2020-02-28    127  211   148   181  167.5  171.182000  27.9515197</span>
<span class="co">#&gt; 17: 2020-02-29    170  279   191   236  218.0  220.354000  34.8622926</span>
<span class="co">#&gt; 18: 2020-03-01    210  346   240   295  278.0  281.272000  43.9618392</span>
<span class="co">#&gt; 19: 2020-03-02    275  439   308   372  347.0  352.716000  52.0314317</span>
<span class="co">#&gt; 20: 2020-03-03    350  556   380   452  432.0  440.314000  63.4711318</span>
<span class="co">#&gt; 21: 2020-03-04    420  655   469   565  535.0  541.896000  75.7848261</span>
<span class="co">#&gt; 22: 2020-03-05    501  799   579   691  645.5  657.996000  93.0728160</span>
<span class="co">#&gt; 23: 2020-03-06    619  964   705   829  787.0  797.702000 105.7470855</span>
<span class="co">#&gt; 24: 2020-03-07    777 1166   822   983  938.5  951.974000 124.5556484</span>
<span class="co">#&gt; 25: 2020-03-08    881 1338   997  1172 1116.0 1130.752000 143.7922352</span>
<span class="co">#&gt; 26: 2020-03-09   1089 1623  1175  1389 1316.5 1336.718000 167.7991764</span>
<span class="co">#&gt; 27: 2020-03-10   1238 1850  1430  1676 1559.0 1570.028000 195.5525628</span>
<span class="co">#&gt; 28: 2020-03-11   1439 2124  1637  1911 1813.5 1822.172000 219.2247006</span>
<span class="co">#&gt; 29: 2020-03-12   1710 2502  1924  2240 2092.0 2107.294000 250.0422801</span>
<span class="co">#&gt; 30: 2020-03-13   1960 2837  2169  2529 2396.0 2413.206000 281.8965038</span>
<span class="co">#&gt; 31: 2020-03-14   2276 3248  2525  2929 2730.5 2758.212000 312.6538019</span>
<span class="co">#&gt; 32: 2020-03-15   2593 3703  2819  3252 3090.5 3110.524000 349.2408220</span>
<span class="co">#&gt; 33: 2020-03-16   2830 4029  3138  3621 3429.5 3469.806000 381.7265496</span>
<span class="co">#&gt; 34: 2020-03-17   3177 4554  3571  4111 3814.5 3839.792000 423.2387018</span>
<span class="co">#&gt; 35: 2020-03-18   3467 4934  3778  4373 4152.5 4200.536000 461.7375269</span>
<span class="co">#&gt; 36: 2020-03-19   3875 5522  4067  4704 4500.0 4544.330000 507.0761536</span>
<span class="co">#&gt; 37: 2020-03-20   3988 5680  4492  5195 4785.5 4844.214000 534.5115128</span>
<span class="co">#&gt; 38: 2020-03-21   4251 6001  4585  5285 5046.0 5102.802000 558.3622476</span>
<span class="co">#&gt; 39: 2020-03-22   4494 6345  4631  5391 5249.0 5323.784000 577.3474981</span>
<span class="co">#&gt; 40: 2020-03-23   4479 6407  4829  5587 5425.5 5479.474000 591.1270487</span>
<span class="co">#&gt; 41: 2020-03-24   4600 6541  5133  5851 5558.5 5590.256000 588.0989740</span>
<span class="co">#&gt; 42: 2020-03-25   4670 6535  5121  5863 5581.5 5643.852000 585.7138273</span>
<span class="co">#&gt; 43: 2020-03-26   4803 6694  5230  5947 5598.5 5650.648000 576.7841433</span>
<span class="co">#&gt; 44: 2020-03-27   4838 6654  5054  5760 5578.0 5618.930000 571.3143208</span>
<span class="co">#&gt; 45: 2020-03-28   4762 6530  5014  5717 5509.0 5552.492000 564.5797042</span>
<span class="co">#&gt; 46: 2020-03-29   4606 6355  4912  5579 5402.0 5451.026000 554.9601308</span>
<span class="co">#&gt; 47: 2020-03-30   4469 6180  4925  5608 5314.0 5342.366000 544.6576466</span>
<span class="co">#&gt; 48: 2020-03-31   4384 6016  4703  5368 5195.0 5205.968000 526.6845586</span>
<span class="co">#&gt; 49: 2020-04-01   4307 5905  4733  5398 5042.5 5067.820000 512.4515947</span>
<span class="co">#&gt; 50: 2020-04-02   4139 5690  4526  5131 4896.5 4927.124000 500.7487426</span>
<span class="co">#&gt; 51: 2020-04-03   3933 5503  4471  5067 4748.0 4779.044000 491.6124038</span>
<span class="co">#&gt; 52: 2020-04-04   3853 5351  4285  4883 4610.0 4641.194000 471.3776003</span>
<span class="co">#&gt; 53: 2020-04-05   3673 5165  4280  4833 4474.0 4499.452000 462.9458169</span>
<span class="co">#&gt; 54: 2020-04-06   3650 5112  3958  4550 4348.5 4360.076000 461.9792071</span>
<span class="co">#&gt; 55: 2020-04-07   3480 4947  3906  4514 4203.5 4239.200000 466.6042553</span>
<span class="co">#&gt; 56: 2020-04-08   3385 4876  3725  4380 4079.5 4114.564000 481.9914620</span>
<span class="co">#&gt; 57: 2020-04-09   3104 4815  3476  4189 3973.5 4005.266000 530.0848981</span>
<span class="co">#&gt; 58: 2020-04-10   3029 4915  3372  4166 3869.5 3903.998000 595.2384224</span>
<span class="co">#&gt; 59: 2020-04-11   2697 4874  3173  4063 3766.0 3817.974000 684.7648758</span>
<span class="co">#&gt;           date bottom  top lower upper median        mean          sd</span></pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>
<span class="co">#&gt;                                  measure              estimate numeric_estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date    2990 (530 -- 6704)     &lt;data.table&gt;</span>
<span class="co">#&gt; 2:        Expected change in daily cases                Unsure             0.67</span>
<span class="co">#&gt; 3:            Effective reproduction no.      0.9 (0.4 -- 1.4)     &lt;data.table&gt;</span>
<span class="co">#&gt; 4:                        Rate of growth -0.04 (-0.17 -- 0.11)     &lt;data.table&gt;</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)       -19 (6.3 -- -4)     &lt;data.table&gt;</span></pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">estimates</span>$<span class="no">plots</span>$<span class="no">summary</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-11-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="no">reported_cases</span>)[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"testland"</span>],
   <span class="no">reported_cases</span>[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span></pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="co">## future::plan("multisession")</span>
<span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                                      <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                                      <span class="kw">incubation_period</span> <span class="kw">=</span> <span class="no">incubation_period</span>,
                                      <span class="kw">reporting_delay</span> <span class="kw">=</span> <span class="no">reporting_delay</span>,
                                      <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>,
                                      <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span></pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summarised_results</span>$<span class="no">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                    2944 (577 -- 7131)</span>
<span class="co">#&gt; 2: testland                    2922 (423 -- 7345)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.9 (0.4 -- 1.4)</span>
<span class="co">#&gt; 2:                         Unsure           0.9 (0.4 -- 1.5)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1: -0.04 (-0.18 -- 0.11)          -19.2 (6.5 -- -3.9)</span>
<span class="co">#&gt; 2: -0.03 (-0.17 -- 0.12)          -20.1 (5.6 -- -4.1)</span></pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summary_plot</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-15-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://epiforecasts.io/covid/">limitations</a> as these are key to understanding our results.</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/247464257"><img src="https://zenodo.org/badge/247464257.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
