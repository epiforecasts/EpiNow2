<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Realtime Case Counts and Time-varying Epidemiological Parameters  â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Realtime Case Counts and Time-varying Epidemiological Parameters ">
<meta property="og:description" content="To identify changes in the reproduction number, rate of spread, 
             and doubling time during the course of outbreaks whilst accounting 
             for potential biases due to delays in case reporting.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate realtime case counts and time-varying epidemiological parameters</h1></div>

<p><em>This package is under development.</em></p>
<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools and current best practices. It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development. It assumes that only limited data is available on cases by date of onset and instead uses cases by date of report. These are then imputed to case counts by date of infection using an uncertain reporting delay and incubation period via a Gaussian process based method. Right truncation of cases is dealt with internally by <code>{EpiNow2}</code>, as is propagating uncertainty from all inputs into the final parameter estimates (helping to mitigate spurious findings). Time-varying estimates of the reproduction number are estimated using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a> package by date of infection with a generation time estimate that includes uncertainty and variation over time controlled using a Gaussian process. Time-varying estimates of the rate of growth are derived from the time-varying reproduction estimates and the uncertain generation time. Optionally, the time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process. See the <a href="https://epiforecasts.io/covid/methods.html">methods</a> section of our Covid-19 site for a detailed discussion of the approach.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw pkg">drat</span><span class="kw ns">:::</span><span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)</pre></div>
<p>Install the development version of the package with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underyling infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence).</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">reporting_delay</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="no">reporting_delay</span>$<span class="no">max</span> <span class="kw">&lt;-</span> <span class="fl">30</span>

<span class="no">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.851392</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1228672</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 0.9931765</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1115861</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span></pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">generation_time</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                        <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                         <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                         <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                         <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)

<span class="no">incubation_period</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                          <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                          <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                          <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                          <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span>:<span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span></pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/epinow.html">epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                             <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                             <span class="kw">incubation_period</span> <span class="kw">=</span> <span class="no">incubation_period</span>,
                             <span class="kw">reporting_delay</span> <span class="kw">=</span> <span class="no">reporting_delay</span>,
                             <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>,
                             <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                             <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span></pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">estimates</span>$<span class="no">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;           variable          parameter time       date sample     value strat</span>
<span class="co">#&gt;      1: infections imputed_infections    1 2020-02-11      1  2.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      2: infections imputed_infections    2 2020-02-12      1 14.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      3: infections imputed_infections    3 2020-02-13      1 18.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      4: infections imputed_infections    4 2020-02-14      1 30.000000  &lt;NA&gt;</span>
<span class="co">#&gt;      5: infections imputed_infections    5 2020-02-15      1 41.000000  &lt;NA&gt;</span>
<span class="co">#&gt;     ---                                                                     </span>
<span class="co">#&gt; 445064:      gt_sd              gt_sd   NA       &lt;NA&gt;    996  3.028559  &lt;NA&gt;</span>
<span class="co">#&gt; 445065:      gt_sd              gt_sd   NA       &lt;NA&gt;    997  3.160311  &lt;NA&gt;</span>
<span class="co">#&gt; 445066:      gt_sd              gt_sd   NA       &lt;NA&gt;    998  3.010675  &lt;NA&gt;</span>
<span class="co">#&gt; 445067:      gt_sd              gt_sd   NA       &lt;NA&gt;    999  3.013735  &lt;NA&gt;</span>
<span class="co">#&gt; 445068:      gt_sd              gt_sd   NA       &lt;NA&gt;   1000  3.098191  &lt;NA&gt;</span>
<span class="co">#&gt;             type</span>
<span class="co">#&gt;      1: estimate</span>
<span class="co">#&gt;      2: estimate</span>
<span class="co">#&gt;      3: estimate</span>
<span class="co">#&gt;      4: estimate</span>
<span class="co">#&gt;      5: estimate</span>
<span class="co">#&gt;     ---         </span>
<span class="co">#&gt; 445064:     &lt;NA&gt;</span>
<span class="co">#&gt; 445065:     &lt;NA&gt;</span>
<span class="co">#&gt; 445066:     &lt;NA&gt;</span>
<span class="co">#&gt; 445067:     &lt;NA&gt;</span>
<span class="co">#&gt; 445068:     &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date          variable strat     type      bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22                 R  &lt;NA&gt; estimate    1.501892    2.667404</span>
<span class="co">#&gt;   2: 2020-02-23                 R  &lt;NA&gt; estimate    1.537981    2.564502</span>
<span class="co">#&gt;   3: 2020-02-24                 R  &lt;NA&gt; estimate    1.633183    2.544770</span>
<span class="co">#&gt;   4: 2020-02-25                 R  &lt;NA&gt; estimate    1.663295    2.474529</span>
<span class="co">#&gt;   5: 2020-02-26                 R  &lt;NA&gt; estimate    1.666235    2.398062</span>
<span class="co">#&gt;  ---                                                                    </span>
<span class="co">#&gt; 509: 2020-04-14 reported_cases_rt  &lt;NA&gt; forecast 1635.000000 4619.000000</span>
<span class="co">#&gt; 510: 2020-04-15 reported_cases_rt  &lt;NA&gt; forecast 1417.000000 3920.000000</span>
<span class="co">#&gt; 511: 2020-04-16 reported_cases_rt  &lt;NA&gt; forecast 1627.000000 4608.000000</span>
<span class="co">#&gt; 512: 2020-04-17 reported_cases_rt  &lt;NA&gt; forecast 1870.000000 5621.000000</span>
<span class="co">#&gt; 513: 2020-04-18 reported_cases_rt  &lt;NA&gt; forecast 1427.000000 4794.000000</span>
<span class="co">#&gt;            lower       upper      median        mean           sd</span>
<span class="co">#&gt;   1:    1.833586    2.283295    2.067344    2.092490    0.3679219</span>
<span class="co">#&gt;   2:    1.806131    2.213249    2.058731    2.080386    0.3226472</span>
<span class="co">#&gt;   3:    1.878691    2.238740    2.050003    2.068483    0.2839785</span>
<span class="co">#&gt;   4:    1.836540    2.159936    2.036259    2.056260    0.2519825</span>
<span class="co">#&gt;   5:    1.831241    2.124125    2.024778    2.043170    0.2265238</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 509: 2360.000000 3493.000000 3073.000000 3215.978000  987.1810208</span>
<span class="co">#&gt; 510: 2014.000000 3013.000000 2591.500000 2686.466000  822.8030759</span>
<span class="co">#&gt; 511: 2225.000000 3481.000000 2953.500000 3073.704000  996.1365491</span>
<span class="co">#&gt; 512: 2385.000000 3769.000000 3361.000000 3593.950000 1291.9960252</span>
<span class="co">#&gt; 513: 2123.000000 3335.000000 2891.500000 3113.378000 1154.0598864</span></pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">estimates</span>$<span class="no">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;        sample       date cases</span>
<span class="co">#&gt;     1:      1 2020-02-16     1</span>
<span class="co">#&gt;     2:      1 2020-02-17     7</span>
<span class="co">#&gt;     3:      1 2020-02-18     8</span>
<span class="co">#&gt;     4:      1 2020-02-19    10</span>
<span class="co">#&gt;     5:      1 2020-02-20    10</span>
<span class="co">#&gt;    ---                        </span>
<span class="co">#&gt; 57467:   1000 2020-04-07  4116</span>
<span class="co">#&gt; 57468:   1000 2020-04-08  4025</span>
<span class="co">#&gt; 57469:   1000 2020-04-09  3879</span>
<span class="co">#&gt; 57470:   1000 2020-04-10  3856</span>
<span class="co">#&gt; 57471:   1000 2020-04-11  3740</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date bottom  top lower upper median         mean          sd</span>
<span class="co">#&gt;  1: 2020-02-11      1    1     1     1    1.0    1.0000000   0.0000000</span>
<span class="co">#&gt;  2: 2020-02-12      0    1     1     1    1.0    0.9642857   0.3313433</span>
<span class="co">#&gt;  3: 2020-02-13      0    2     1     1    1.0    1.0243902   0.5189799</span>
<span class="co">#&gt;  4: 2020-02-14      0    2     1     1    1.0    1.1323829   0.7455926</span>
<span class="co">#&gt;  5: 2020-02-15      0    3     1     2    2.0    1.6711491   1.1425557</span>
<span class="co">#&gt;  6: 2020-02-16      0    5     1     3    3.0    2.8293692   1.7962596</span>
<span class="co">#&gt;  7: 2020-02-17      1    8     2     5    5.0    4.9109109   2.4918848</span>
<span class="co">#&gt;  8: 2020-02-18      3   13     4     8    8.0    8.0700000   3.3211640</span>
<span class="co">#&gt;  9: 2020-02-19      6   19     8    13   12.0   12.5070000   4.1568293</span>
<span class="co">#&gt; 10: 2020-02-20     10   27    12    19   18.0   18.6240000   5.5459338</span>
<span class="co">#&gt; 11: 2020-02-21     16   37    19    28   26.0   26.8690000   6.9161892</span>
<span class="co">#&gt; 12: 2020-02-22     24   50    32    42   38.0   37.7820000   8.2097427</span>
<span class="co">#&gt; 13: 2020-02-23     34   67    40    54   50.0   50.7040000  10.4918284</span>
<span class="co">#&gt; 14: 2020-02-24     46   86    58    74   68.0   67.6660000  12.2798713</span>
<span class="co">#&gt; 15: 2020-02-25     60  109    78    97   87.0   87.7240000  14.9173171</span>
<span class="co">#&gt; 16: 2020-02-26     82  139    95   119  112.0  112.5100000  17.9486505</span>
<span class="co">#&gt; 17: 2020-02-27    105  174   118   147  141.0  142.2950000  21.2733291</span>
<span class="co">#&gt; 18: 2020-02-28    135  217   157   190  179.5  179.0820000  24.8293732</span>
<span class="co">#&gt; 19: 2020-02-29    176  271   193   233  223.0  224.3280000  29.9034552</span>
<span class="co">#&gt; 20: 2020-03-01    220  337   250   298  279.0  279.3800000  35.8477986</span>
<span class="co">#&gt; 21: 2020-03-02    272  408   315   370  345.0  344.8620000  42.5188759</span>
<span class="co">#&gt; 22: 2020-03-03    341  504   379   444  423.0  424.6710000  50.4451928</span>
<span class="co">#&gt; 23: 2020-03-04    421  617   476   555  520.0  522.0840000  60.4898998</span>
<span class="co">#&gt; 24: 2020-03-05    529  760   591   683  638.0  637.1530000  72.2154461</span>
<span class="co">#&gt; 25: 2020-03-06    624  903   702   816  768.0  772.8550000  86.0532459</span>
<span class="co">#&gt; 26: 2020-03-07    763 1089   860   997  925.0  928.8020000 101.6358137</span>
<span class="co">#&gt; 27: 2020-03-08    909 1284  1007  1166 1104.0 1108.2430000 117.2386748</span>
<span class="co">#&gt; 28: 2020-03-09   1088 1523  1230  1407 1304.5 1308.4250000 134.5964880</span>
<span class="co">#&gt; 29: 2020-03-10   1300 1804  1396  1611 1524.5 1532.4770000 158.6410932</span>
<span class="co">#&gt; 30: 2020-03-11   1486 2062  1646  1890 1769.0 1783.5730000 180.5044945</span>
<span class="co">#&gt; 31: 2020-03-12   1718 2386  1859  2137 2043.5 2057.9040000 205.5849020</span>
<span class="co">#&gt; 32: 2020-03-13   1973 2719  2125  2439 2342.5 2356.5950000 232.9936244</span>
<span class="co">#&gt; 33: 2020-03-14   2262 3095  2419  2770 2664.5 2673.2330000 261.7289758</span>
<span class="co">#&gt; 34: 2020-03-15   2533 3432  2758  3137 2993.0 3010.8590000 285.3732907</span>
<span class="co">#&gt; 35: 2020-03-16   2849 3824  3051  3448 3325.0 3345.9050000 304.9690642</span>
<span class="co">#&gt; 36: 2020-03-17   3132 4170  3398  3816 3654.5 3671.1910000 326.9711036</span>
<span class="co">#&gt; 37: 2020-03-18   3432 4525  3746  4187 3969.5 3982.3540000 343.5109641</span>
<span class="co">#&gt; 38: 2020-03-19   3681 4803  3971  4411 4249.5 4269.4940000 355.1281797</span>
<span class="co">#&gt; 39: 2020-03-20   3926 5082  4249  4716 4502.5 4523.2140000 362.2878893</span>
<span class="co">#&gt; 40: 2020-03-21   4099 5263  4503  4972 4712.0 4739.9480000 361.0119651</span>
<span class="co">#&gt; 41: 2020-03-22   4310 5438  4663  5135 4891.0 4912.6080000 359.2910831</span>
<span class="co">#&gt; 42: 2020-03-23   4499 5636  4752  5233 5026.0 5045.0850000 356.5717392</span>
<span class="co">#&gt; 43: 2020-03-24   4581 5678  4855  5304 5117.5 5137.5830000 349.9878893</span>
<span class="co">#&gt; 44: 2020-03-25   4635 5713  4929  5364 5172.0 5190.7700000 341.5032292</span>
<span class="co">#&gt; 45: 2020-03-26   4668 5708  4955  5383 5202.5 5208.1860000 332.7783690</span>
<span class="co">#&gt; 46: 2020-03-27   4682 5714  4964  5371 5174.5 5188.3540000 321.2751226</span>
<span class="co">#&gt; 47: 2020-03-28   4648 5623  4932  5319 5123.5 5144.1560000 309.5141170</span>
<span class="co">#&gt; 48: 2020-03-29   4589 5545  4876  5243 5068.0 5085.7260000 302.8466923</span>
<span class="co">#&gt; 49: 2020-03-30   4493 5438  4801  5158 4999.0 5007.4210000 291.4951306</span>
<span class="co">#&gt; 50: 2020-03-31   4407 5357  4777  5148 4910.5 4918.5030000 290.9900569</span>
<span class="co">#&gt; 51: 2020-04-01   4366 5284  4661  5021 4811.5 4819.9070000 285.2051689</span>
<span class="co">#&gt; 52: 2020-04-02   4269 5152  4518  4872 4722.0 4714.3440000 275.6333895</span>
<span class="co">#&gt; 53: 2020-04-03   4216 5098  4423  4773 4614.5 4607.7680000 277.3306988</span>
<span class="co">#&gt; 54: 2020-04-04   4087 4961  4288  4644 4505.5 4507.7020000 273.1259544</span>
<span class="co">#&gt; 55: 2020-04-05   3921 4801  4217  4556 4410.0 4408.8090000 268.5323670</span>
<span class="co">#&gt; 56: 2020-04-06   3882 4740  4131  4448 4304.5 4306.5310000 263.1154248</span>
<span class="co">#&gt; 57: 2020-04-07   3795 4632  4076  4406 4210.0 4218.1890000 262.7302085</span>
<span class="co">#&gt; 58: 2020-04-08   3717 4567  3964  4290 4121.5 4119.2470000 263.0980398</span>
<span class="co">#&gt; 59: 2020-04-09   3581 4435  3850  4186 4036.0 4030.9530000 263.7660655</span>
<span class="co">#&gt; 60: 2020-04-10   3509 4394  3768  4093 3943.5 3941.1710000 268.0961904</span>
<span class="co">#&gt; 61: 2020-04-11   3461 4343  3662  3992 3853.5 3853.9540000 265.9008145</span>
<span class="co">#&gt;           date bottom  top lower upper median         mean          sd</span></pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>
<span class="co">#&gt;                                  measure              estimate numeric_estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date   3048 (2499 -- 3621)     &lt;data.table&gt;</span>
<span class="co">#&gt; 2:        Expected change in daily cases                Unsure             0.73</span>
<span class="co">#&gt; 3:            Effective reproduction no.      0.8 (0.4 -- 1.4)     &lt;data.table&gt;</span>
<span class="co">#&gt; 4:                        Rate of growth -0.05 (-0.18 -- 0.12)     &lt;data.table&gt;</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)   -12.8 (5.8 -- -3.9)     &lt;data.table&gt;</span></pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">estimates</span>$<span class="no">plots</span>$<span class="no">summary</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-11-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="no">reported_cases</span>)[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"testland"</span>],
   <span class="no">reported_cases</span>[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span></pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="co">## future::plan("multisession")</span>
<span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                                      <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                                      <span class="kw">incubation_period</span> <span class="kw">=</span> <span class="no">incubation_period</span>,
                                      <span class="kw">reporting_delay</span> <span class="kw">=</span> <span class="no">reporting_delay</span>,
                                      <span class="kw">rt_prior</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">1</span>), <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>,
                                      <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>,
                                      <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summarised_results</span>$<span class="no">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                   3062 (2596 -- 3652)</span>
<span class="co">#&gt; 2: testland                   3055 (2476 -- 3545)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.8 (0.4 -- 1.4)</span>
<span class="co">#&gt; 2:                         Unsure           0.8 (0.4 -- 1.4)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1: -0.04 (-0.18 -- 0.11)          -15.7 (6.4 -- -3.8)</span>
<span class="co">#&gt; 2: -0.05 (-0.19 -- 0.11)          -13.2 (6.5 -- -3.7)</span></pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summary_plot</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-15-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://epiforecasts.io/covid/">limitations</a> as these are key to understanding our results.</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/247464257"><img src="https://zenodo.org/badge/247464257.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
