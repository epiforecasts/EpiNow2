<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Realtime Case Counts and Time-varying Epidemiological Parameters  â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Realtime Case Counts and Time-varying Epidemiological Parameters ">
<meta property="og:description" content="To identify changes in the reproduction number, rate of spread, 
             and doubling time during the course of outbreaks whilst accounting 
             for potential biases due to delays in case reporting.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate realtime case counts and time-varying epidemiological parameters</h1></div>

<p><em>This package is under development.</em></p>
<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools and current best practices. It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development. It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in this example an incubation period and a reporting delay) and a reporting model that can include weekly periodicity. The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number but optionally a stationary Gaussian process may be used (faster to estimate but reduced performance for real time estimates) and arbitrary breakpoints can be defined. Propagating uncertainty from all inputs into the final parameter estimates (helping to mitigate spurious findings) is handled internally. Time-varying estimates of the rate of growth are derived from the time-varying reproduction estimates and the uncertain generation time. Optionally, the time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process. As a standalone tool non-parametric back-calculation is also supported using a novel formulation based on a smoothed mean delay shift of reported cases combined with a Gaussian process to determine the most likely outbreak trajectory.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw pkg">drat</span><span class="kw ns">:::</span><span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)</pre></div>
<p>Install the development version of the package with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underlying infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">reporting_delay</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="no">reporting_delay</span>$<span class="no">max</span> <span class="kw">&lt;-</span> <span class="fl">30</span>

<span class="no">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.527408</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1274648</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.086828</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1282467</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span></pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">generation_time</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                        <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                         <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                         <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                         <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)

<span class="no">incubation_period</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                          <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                          <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                          <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                          <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span>:<span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span></pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/epinow.html">epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                             <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                             <span class="kw">delays</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">incubation_period</span>, <span class="no">reporting_delay</span>),
                             <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>,
                             <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                             <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span></pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">estimates</span>$<span class="no">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;                 variable          parameter time       date sample    value</span>
<span class="co">#&gt;      1:       infections imputed_infections    1 2020-02-09      1    1.000</span>
<span class="co">#&gt;      2:       infections imputed_infections    2 2020-02-10      1   17.000</span>
<span class="co">#&gt;      3:       infections imputed_infections    3 2020-02-11      1   23.000</span>
<span class="co">#&gt;      4:       infections imputed_infections    4 2020-02-12      1   32.000</span>
<span class="co">#&gt;      5:       infections imputed_infections    5 2020-02-13      1   41.000</span>
<span class="co">#&gt;     ---                                                                    </span>
<span class="co">#&gt; 190566: prior_infections   prior_infections   66 2020-04-14      1 2714.255</span>
<span class="co">#&gt; 190567: prior_infections   prior_infections   67 2020-04-15      1 2647.130</span>
<span class="co">#&gt; 190568: prior_infections   prior_infections   68 2020-04-16      1 2581.666</span>
<span class="co">#&gt; 190569: prior_infections   prior_infections   69 2020-04-17      1 2517.820</span>
<span class="co">#&gt; 190570: prior_infections   prior_infections   70 2020-04-18      1 2455.553</span>
<span class="co">#&gt;         strat     type</span>
<span class="co">#&gt;      1:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      2:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      3:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      4:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      5:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;     ---               </span>
<span class="co">#&gt; 190566:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 190567:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 190568:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 190569:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 190570:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type     bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate   1.031456    1.643384</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate   1.130377    1.640762</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate   1.244211    1.659314</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate   1.325784    1.647996</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate   1.419506    1.677153</span>
<span class="co">#&gt;  ---                                                                </span>
<span class="co">#&gt; 320: 2020-04-14 reported_cases  &lt;NA&gt; forecast 817.000000 5661.000000</span>
<span class="co">#&gt; 321: 2020-04-15 reported_cases  &lt;NA&gt; forecast 626.000000 5082.000000</span>
<span class="co">#&gt; 322: 2020-04-16 reported_cases  &lt;NA&gt; forecast 470.000000 6586.000000</span>
<span class="co">#&gt; 323: 2020-04-17 reported_cases  &lt;NA&gt; forecast 684.000000 8159.000000</span>
<span class="co">#&gt; 324: 2020-04-18 reported_cases  &lt;NA&gt; forecast 406.000000 6775.000000</span>
<span class="co">#&gt;            lower       upper      median        mean           sd</span>
<span class="co">#&gt;   1:    1.215955    1.453638    1.329942    1.335355 1.900852e-01</span>
<span class="co">#&gt;   2:    1.295350    1.482316    1.373187    1.380484 1.551254e-01</span>
<span class="co">#&gt;   3:    1.354248    1.505699    1.427582    1.431017 1.236163e-01</span>
<span class="co">#&gt;   4:    1.406273    1.527438    1.483581    1.485570 9.758853e-02</span>
<span class="co">#&gt;   5:    1.479097    1.585354    1.541611    1.542410 8.025973e-02</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 320: 1340.000000 3153.000000 2759.000000 3257.640000 1.896348e+03</span>
<span class="co">#&gt; 321: 1190.000000 2777.000000 2371.000000 2895.214667 2.009576e+03</span>
<span class="co">#&gt; 322:  866.000000 2951.000000 2826.500000 3783.304000 4.119070e+03</span>
<span class="co">#&gt; 323: 1067.000000 3326.000000 3213.000000 4458.073333 5.356846e+03</span>
<span class="co">#&gt; 324:  994.000000 2903.000000 2572.500000 4558.794667 1.949937e+04</span></pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">estimates</span>$<span class="no">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;              date sample cases  type</span>
<span class="co">#&gt;     1: 2020-02-22      1    78 gp_rt</span>
<span class="co">#&gt;     2: 2020-02-23      1   130 gp_rt</span>
<span class="co">#&gt;     3: 2020-02-24      1   127 gp_rt</span>
<span class="co">#&gt;     4: 2020-02-25      1   178 gp_rt</span>
<span class="co">#&gt;     5: 2020-02-26      1   302 gp_rt</span>
<span class="co">#&gt;    ---                              </span>
<span class="co">#&gt; 42746: 2020-04-14    750  4928 gp_rt</span>
<span class="co">#&gt; 42747: 2020-04-15    750  3190 gp_rt</span>
<span class="co">#&gt; 42748: 2020-04-16    750  5068 gp_rt</span>
<span class="co">#&gt; 42749: 2020-04-17    750  2330 gp_rt</span>
<span class="co">#&gt; 42750: 2020-04-18    750   886 gp_rt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date  type bottom   top lower upper median       mean          sd</span>
<span class="co">#&gt;  1: 2020-02-22 gp_rt     29   144    61   105   81.5   88.34133    39.73774</span>
<span class="co">#&gt;  2: 2020-02-23 gp_rt     45   203    71   130  115.0  122.58400    50.69082</span>
<span class="co">#&gt;  3: 2020-02-24 gp_rt     48   238    85   157  137.0  144.65067    59.99840</span>
<span class="co">#&gt;  4: 2020-02-25 gp_rt     51   236    83   156  139.0  147.69200    63.50802</span>
<span class="co">#&gt;  5: 2020-02-26 gp_rt     51   236    92   164  143.0  149.01600    63.64729</span>
<span class="co">#&gt;  6: 2020-02-27 gp_rt     58   319   113   216  192.0  205.03733    87.61811</span>
<span class="co">#&gt;  7: 2020-02-28 gp_rt    108   488   177   312  262.0  285.08000   124.13407</span>
<span class="co">#&gt;  8: 2020-02-29 gp_rt     63   420   148   280  252.0  268.76133   117.52521</span>
<span class="co">#&gt;  9: 2020-03-01 gp_rt    128   574   185   357  320.0  348.63733   146.66506</span>
<span class="co">#&gt; 10: 2020-03-02 gp_rt    122   621   232   415  369.0  392.01467   162.76795</span>
<span class="co">#&gt; 11: 2020-03-03 gp_rt     95   664   229   446  375.0  409.15467   192.00358</span>
<span class="co">#&gt; 12: 2020-03-04 gp_rt    131   712   252   476  412.0  435.62400   192.47774</span>
<span class="co">#&gt; 13: 2020-03-05 gp_rt    162   998   370   674  550.5  601.92533   290.37822</span>
<span class="co">#&gt; 14: 2020-03-06 gp_rt    325  1381   442   881  796.0  853.70267   378.74638</span>
<span class="co">#&gt; 15: 2020-03-07 gp_rt    331  1369   548   969  811.5  860.34667   355.97659</span>
<span class="co">#&gt; 16: 2020-03-08 gp_rt    415  1831   599  1161 1050.5 1128.63867   469.11368</span>
<span class="co">#&gt; 17: 2020-03-09 gp_rt    489  2339   746  1435 1238.5 1364.30000   631.82231</span>
<span class="co">#&gt; 18: 2020-03-10 gp_rt    448  2311   960  1655 1319.5 1409.01733   609.48195</span>
<span class="co">#&gt; 19: 2020-03-11 gp_rt    514  2438   864  1639 1369.0 1484.02000   656.28348</span>
<span class="co">#&gt; 20: 2020-03-12 gp_rt    580  3237  1141  2184 1876.5 2035.95733   914.36416</span>
<span class="co">#&gt; 21: 2020-03-13 gp_rt    894  4431  1376  2784 2586.5 2753.69600  1201.86701</span>
<span class="co">#&gt; 22: 2020-03-14 gp_rt    843  4140  1726  2959 2451.0 2611.85200  1101.61667</span>
<span class="co">#&gt; 23: 2020-03-15 gp_rt   1303  5966  2005  3832 3393.5 3602.95733  1588.99724</span>
<span class="co">#&gt; 24: 2020-03-16 gp_rt   1296  6134  2492  4376 3547.5 3871.68667  1711.36168</span>
<span class="co">#&gt; 25: 2020-03-17 gp_rt   1291  6128  2243  4164 3451.5 3679.53867  1610.40241</span>
<span class="co">#&gt; 26: 2020-03-18 gp_rt   1292  5781  2042  3844 3239.0 3503.53733  1512.48106</span>
<span class="co">#&gt; 27: 2020-03-19 gp_rt   1330  7340  2900  5100 4246.5 4592.70133  1991.00905</span>
<span class="co">#&gt; 28: 2020-03-20 gp_rt   1508  9117  3775  6928 5417.5 5676.22000  2493.51734</span>
<span class="co">#&gt; 29: 2020-03-21 gp_rt   1714  8111  2959  5335 4595.5 4899.81467  2085.27548</span>
<span class="co">#&gt; 30: 2020-03-22 gp_rt   2131  9422  3575  6653 5508.0 5965.88533  2553.30391</span>
<span class="co">#&gt; 31: 2020-03-23 gp_rt   2048  9860  3110  6274 5653.0 6052.94533  2776.83507</span>
<span class="co">#&gt; 32: 2020-03-24 gp_rt   1771  8587  3028  5856 5035.0 5387.12933  2389.35927</span>
<span class="co">#&gt; 33: 2020-03-25 gp_rt   1601  7883  2703  4936 4338.0 4723.21733  2137.51451</span>
<span class="co">#&gt; 34: 2020-03-26 gp_rt   2202  9784  3291  6089 5175.0 5578.57867  2421.90847</span>
<span class="co">#&gt; 35: 2020-03-27 gp_rt   2080 10745  3178  6717 6292.5 6762.29600  2885.33647</span>
<span class="co">#&gt; 36: 2020-03-28 gp_rt   1690  8793  3554  6182 5087.0 5417.26267  2354.17336</span>
<span class="co">#&gt; 37: 2020-03-29 gp_rt   2162  9975  3267  6205 5554.0 6017.21867  2532.60931</span>
<span class="co">#&gt; 38: 2020-03-30 gp_rt   1729  9292  3837  6877 5535.0 5870.34800  2656.91216</span>
<span class="co">#&gt; 39: 2020-03-31 gp_rt   1814  7972  2641  5052 4667.0 4983.34133  2141.01872</span>
<span class="co">#&gt; 40: 2020-04-01 gp_rt   1504  7079  2103  4250 3878.0 4228.43600  1898.33112</span>
<span class="co">#&gt; 41: 2020-04-02 gp_rt   1611  8219  2829  5257 4442.0 4877.50400  2229.40326</span>
<span class="co">#&gt; 42: 2020-04-03 gp_rt   1903  9883  3737  6640 5544.0 5988.91467  2737.11117</span>
<span class="co">#&gt; 43: 2020-04-04 gp_rt   1649  7369  3014  5280 4302.5 4604.32800  1956.88003</span>
<span class="co">#&gt; 44: 2020-04-05 gp_rt   1755  8233  2940  5420 4578.5 4995.66000  2213.54995</span>
<span class="co">#&gt; 45: 2020-04-06 gp_rt   1576  8066  3046  5604 4390.5 4810.41467  2303.15856</span>
<span class="co">#&gt; 46: 2020-04-07 gp_rt   1457  6938  2269  4416 3872.5 4090.59067  1778.42554</span>
<span class="co">#&gt; 47: 2020-04-08 gp_rt   1146  5626  2091  3843 3211.0 3450.28933  1576.87726</span>
<span class="co">#&gt; 48: 2020-04-09 gp_rt   1411  6404  2399  4370 3608.0 3923.92400  1718.23288</span>
<span class="co">#&gt; 49: 2020-04-10 gp_rt   1601  7974  2731  5136 4142.5 4511.35600  2123.64436</span>
<span class="co">#&gt; 50: 2020-04-11 gp_rt   1065  5654  2213  3994 3285.5 3531.29467  1600.48263</span>
<span class="co">#&gt; 51: 2020-04-12 gp_rt   1402  7536  1951  4114 3620.5 4134.67067  2243.13357</span>
<span class="co">#&gt; 52: 2020-04-13 gp_rt    829  6930  1595  3728 3400.5 3862.61600  2110.01246</span>
<span class="co">#&gt; 53: 2020-04-14 gp_rt    817  5661  1340  3153 2759.0 3257.64000  1896.34758</span>
<span class="co">#&gt; 54: 2020-04-15 gp_rt    626  5082  1190  2777 2371.0 2895.21467  2009.57645</span>
<span class="co">#&gt; 55: 2020-04-16 gp_rt    470  6586   866  2951 2826.5 3783.30400  4119.07026</span>
<span class="co">#&gt; 56: 2020-04-17 gp_rt    684  8159  1067  3326 3213.0 4458.07333  5356.84640</span>
<span class="co">#&gt; 57: 2020-04-18 gp_rt    406  6775   994  2903 2572.5 4558.79467 19499.37256</span>
<span class="co">#&gt;           date  type bottom   top lower upper median       mean          sd</span></pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>
<span class="co">#&gt;                                  measure             estimate numeric_estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date   2556 (139 -- 7447)     &lt;data.table&gt;</span>
<span class="co">#&gt; 2:        Expected change in daily cases               Unsure              0.7</span>
<span class="co">#&gt; 3:            Effective reproduction no.     0.8 (0.3 -- 1.5)     &lt;data.table&gt;</span>
<span class="co">#&gt; 4:                        Rate of growth -0.05 (-0.2 -- 0.12)     &lt;data.table&gt;</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)  -15.2 (5.7 -- -3.5)     &lt;data.table&gt;</span></pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">estimates</span>$<span class="no">plots</span>$<span class="no">summary</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-11-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="no">reported_cases</span>)[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"testland"</span>],
   <span class="no">reported_cases</span>[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span></pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="co">## future::plan("multisession")</span>
<span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                                      <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                                      <span class="kw">delays</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">incubation_period</span>, <span class="no">reporting_delay</span>),
                                      <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>,
                                      <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>,
                                      <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span></pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summarised_results</span>$<span class="no">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                     2384 (64 -- 6945)</span>
<span class="co">#&gt; 2: testland                    2437 (211 -- 6520)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.8 (0.3 -- 1.4)</span>
<span class="co">#&gt; 2:                         Unsure           0.8 (0.4 -- 1.4)</span>
<span class="co">#&gt;          Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1: -0.05 (-0.22 -- 0.1)          -13.2 (6.7 -- -3.1)</span>
<span class="co">#&gt; 2: -0.05 (-0.18 -- 0.1)          -13.1 (7.2 -- -3.8)</span></pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summary_plot</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-15-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://epiforecasts.io/covid/">limitations</a> as these are key to understanding our results.</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Paul Mee <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/247464257"><img src="https://zenodo.org/badge/247464257.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Paul Mee, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
