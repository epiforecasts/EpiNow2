<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Realtime Case Counts and Time-varying Epidemiological Parameters  â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Realtime Case Counts and Time-varying Epidemiological Parameters ">
<meta property="og:description" content="To identify changes in the reproduction number, rate of spread, 
             and doubling time during the course of outbreaks whilst accounting 
             for potential biases due to delays in case reporting.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-realtime-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate realtime case counts and time-varying epidemiological parameters</h1></div>

<p><em>This package is under development.</em></p>
<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools and current best practices. It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development. It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in this example an incubation period and a reporting delay) and a reporting model that can include weekly periodicity. The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number but optionally a stationary Gaussian process may be used (faster to estimate but reduced performance for real time estimates) and arbitrary breakpoints can be defined. Propagating uncertainty from all inputs into the final parameter estimates (helping to mitigate spurious findings) is handled internally. Time-varying estimates of the rate of growth are derived from the time-varying reproduction estimates and the uncertain generation time. Optionally, the time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process. As a standalone tool non-parametric back-calculation is also supported using a novel formulation based on a smoothed mean delay shift of reported cases combined with a Gaussian process to determine the most likely outbreak trajectory.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw pkg">drat</span><span class="kw ns">:::</span><span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)</pre></div>
<p>Install the development version of the package with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underlying infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">reporting_delay</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="no">reporting_delay</span>$<span class="no">max</span> <span class="kw">&lt;-</span> <span class="fl">30</span>

<span class="no">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.698169</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1546306</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.114934</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1117431</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span></pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">generation_time</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                        <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                         <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                         <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                         <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)

<span class="no">incubation_period</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean</span>,
                          <span class="kw">mean_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">mean_sd</span>,
                          <span class="kw">sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd</span>,
                          <span class="kw">sd_sd</span> <span class="kw">=</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]$<span class="no">sd_sd</span>,
                          <span class="kw">max</span> <span class="kw">=</span> <span class="fl">30</span>)</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="no"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span>:<span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span></pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/epinow.html">epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                             <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                             <span class="kw">delays</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">incubation_period</span>, <span class="no">reporting_delay</span>),
                             <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>,
                             <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                             <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span></pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">estimates</span>$<span class="no">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;                 variable          parameter time       date sample    value</span>
<span class="co">#&gt;      1:       infections imputed_infections    1 2020-02-07      1    3.000</span>
<span class="co">#&gt;      2:       infections imputed_infections    2 2020-02-08      1   16.000</span>
<span class="co">#&gt;      3:       infections imputed_infections    3 2020-02-09      1   22.000</span>
<span class="co">#&gt;      4:       infections imputed_infections    4 2020-02-10      1   37.000</span>
<span class="co">#&gt;      5:       infections imputed_infections    5 2020-02-11      1   41.000</span>
<span class="co">#&gt;     ---                                                                    </span>
<span class="co">#&gt; 128068: prior_infections   prior_infections   68 2020-04-14      1 2581.666</span>
<span class="co">#&gt; 128069: prior_infections   prior_infections   69 2020-04-15      1 2517.820</span>
<span class="co">#&gt; 128070: prior_infections   prior_infections   70 2020-04-16      1 2455.553</span>
<span class="co">#&gt; 128071: prior_infections   prior_infections   71 2020-04-17      1 2394.826</span>
<span class="co">#&gt; 128072: prior_infections   prior_infections   72 2020-04-18      1 2335.601</span>
<span class="co">#&gt;         strat     type</span>
<span class="co">#&gt;      1:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      2:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      3:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      4:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      5:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;     ---               </span>
<span class="co">#&gt; 128068:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 128069:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 128070:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 128071:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 128072:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type      bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate   0.7564282    1.414028</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate   0.8846257    1.448911</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate   0.9631228    1.437619</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate   1.0954422    1.468108</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate   1.2025306    1.512359</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 324: 2020-04-14 reported_cases  &lt;NA&gt; forecast 374.0000000 6874.000000</span>
<span class="co">#&gt; 325: 2020-04-15 reported_cases  &lt;NA&gt; forecast 142.0000000 5239.000000</span>
<span class="co">#&gt; 326: 2020-04-16 reported_cases  &lt;NA&gt; forecast 361.0000000 6498.000000</span>
<span class="co">#&gt; 327: 2020-04-17 reported_cases  &lt;NA&gt; forecast 458.0000000 9039.000000</span>
<span class="co">#&gt; 328: 2020-04-18 reported_cases  &lt;NA&gt; forecast 204.0000000 7451.000000</span>
<span class="co">#&gt;             lower       upper      median        mean           sd</span>
<span class="co">#&gt;   1:    0.9459273    1.234976    1.105647    1.113589 2.057302e-01</span>
<span class="co">#&gt;   2:    0.9905997    1.236385    1.162262    1.166212 1.754555e-01</span>
<span class="co">#&gt;   3:    1.1198978    1.322856    1.228027    1.226912 1.457745e-01</span>
<span class="co">#&gt;   4:    1.2053574    1.371572    1.295255    1.294681 1.183796e-01</span>
<span class="co">#&gt;   5:    1.3104278    1.437038    1.368334    1.367978 9.674816e-02</span>
<span class="co">#&gt;  ---                                                              </span>
<span class="co">#&gt; 324: 1075.0000000 2992.000000 2746.500000 3550.534000 3.046264e+03</span>
<span class="co">#&gt; 325: 1057.0000000 2669.000000 2226.000000 2855.966000 2.525423e+03</span>
<span class="co">#&gt; 326:  653.0000000 2748.000000 2574.500000 3628.484000 4.226875e+03</span>
<span class="co">#&gt; 327: 1045.0000000 3289.000000 2876.000000 4804.820000 8.242916e+03</span>
<span class="co">#&gt; 328:  917.0000000 2695.000000 2378.500000 4145.540000 8.458841e+03</span></pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">estimates</span>$<span class="no">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;              date sample cases  type</span>
<span class="co">#&gt;     1: 2020-02-22      1   119 gp_rt</span>
<span class="co">#&gt;     2: 2020-02-23      1    97 gp_rt</span>
<span class="co">#&gt;     3: 2020-02-24      1    73 gp_rt</span>
<span class="co">#&gt;     4: 2020-02-25      1   331 gp_rt</span>
<span class="co">#&gt;     5: 2020-02-26      1   210 gp_rt</span>
<span class="co">#&gt;    ---                              </span>
<span class="co">#&gt; 28496: 2020-04-14    500  3076 gp_rt</span>
<span class="co">#&gt; 28497: 2020-04-15    500  1456 gp_rt</span>
<span class="co">#&gt; 28498: 2020-04-16    500  3279 gp_rt</span>
<span class="co">#&gt; 28499: 2020-04-17    500  5650 gp_rt</span>
<span class="co">#&gt; 28500: 2020-04-18    500  2047 gp_rt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean         sd</span>
<span class="co">#&gt;  1: 2020-02-22 gp_rt     31   230    66   140  121.0  135.552   69.91704</span>
<span class="co">#&gt;  2: 2020-02-23 gp_rt     43   306    83   188  166.5  174.868   86.47373</span>
<span class="co">#&gt;  3: 2020-02-24 gp_rt     47   357   117   235  185.0  206.276  112.55849</span>
<span class="co">#&gt;  4: 2020-02-25 gp_rt     36   363   113   229  194.0  215.566  113.04736</span>
<span class="co">#&gt;  5: 2020-02-26 gp_rt     60   354   106   215  186.5  202.662   97.72685</span>
<span class="co">#&gt;  6: 2020-02-27 gp_rt     50   446   115   263  229.5  260.560  136.64177</span>
<span class="co">#&gt;  7: 2020-02-28 gp_rt     93   632   159   366  326.5  357.236  184.91553</span>
<span class="co">#&gt;  8: 2020-02-29 gp_rt     93   570   157   332  289.0  329.884  179.01133</span>
<span class="co">#&gt;  9: 2020-03-01 gp_rt     99   692   184   407  356.5  398.796  206.27769</span>
<span class="co">#&gt; 10: 2020-03-02 gp_rt    129   765   184   410  384.0  431.012  218.11775</span>
<span class="co">#&gt; 11: 2020-03-03 gp_rt    100   777   177   433  401.5  440.188  228.74989</span>
<span class="co">#&gt; 12: 2020-03-04 gp_rt     82   711   231   483  383.5  428.928  232.34748</span>
<span class="co">#&gt; 13: 2020-03-05 gp_rt    110  1073   256   638  557.5  627.182  337.31880</span>
<span class="co">#&gt; 14: 2020-03-06 gp_rt    221  1420   463   946  773.0  862.396  454.21571</span>
<span class="co">#&gt; 15: 2020-03-07 gp_rt    172  1495   383   883  748.5  852.600  458.96804</span>
<span class="co">#&gt; 16: 2020-03-08 gp_rt    208  2034   539  1208 1051.0 1170.814  633.95379</span>
<span class="co">#&gt; 17: 2020-03-09 gp_rt    320  2356   554  1357 1224.5 1371.076  748.93441</span>
<span class="co">#&gt; 18: 2020-03-10 gp_rt    389  2480   732  1567 1292.0 1393.288  695.64383</span>
<span class="co">#&gt; 19: 2020-03-11 gp_rt    320  2524   572  1484 1274.5 1452.322  800.00725</span>
<span class="co">#&gt; 20: 2020-03-12 gp_rt    616  3651  1010  2093 1828.0 2071.244 1078.45410</span>
<span class="co">#&gt; 21: 2020-03-13 gp_rt    614  5053  1234  2818 2522.5 2790.782 1596.56347</span>
<span class="co">#&gt; 22: 2020-03-14 gp_rt    527  4576  1396  2896 2467.0 2762.042 1438.36390</span>
<span class="co">#&gt; 23: 2020-03-15 gp_rt    871  5761  1820  3758 3133.5 3397.316 1670.04978</span>
<span class="co">#&gt; 24: 2020-03-16 gp_rt    858  6667  1576  3934 3475.0 3845.562 2081.31864</span>
<span class="co">#&gt; 25: 2020-03-17 gp_rt    706  6464  1596  3892 3478.0 3787.802 1993.28062</span>
<span class="co">#&gt; 26: 2020-03-18 gp_rt    778  6016  1930  3931 3289.0 3619.738 1999.37828</span>
<span class="co">#&gt; 27: 2020-03-19 gp_rt   1077  8256  2289  4937 4260.0 4733.790 2656.64362</span>
<span class="co">#&gt; 28: 2020-03-20 gp_rt   1540 10942  2777  6104 5412.0 6057.274 3536.53122</span>
<span class="co">#&gt; 29: 2020-03-21 gp_rt   1546  8833  2626  5686 4685.5 5106.524 2473.41052</span>
<span class="co">#&gt; 30: 2020-03-22 gp_rt   1587 10402  3436  7084 5589.5 6105.698 3008.77807</span>
<span class="co">#&gt; 31: 2020-03-23 gp_rt   1957 10848  2963  6316 5578.0 6159.720 3310.74146</span>
<span class="co">#&gt; 32: 2020-03-24 gp_rt   1407  9299  3098  6177 4864.5 5237.604 2629.14262</span>
<span class="co">#&gt; 33: 2020-03-25 gp_rt   1180  7753  2655  5223 4071.5 4531.636 2244.29211</span>
<span class="co">#&gt; 34: 2020-03-26 gp_rt   1459  9687  2813  6137 5298.5 5660.282 2881.43164</span>
<span class="co">#&gt; 35: 2020-03-27 gp_rt   1124 11926  3790  7785 6376.5 7062.978 3782.16643</span>
<span class="co">#&gt; 36: 2020-03-28 gp_rt   1332 10161  2750  5885 5126.0 5791.106 3224.55387</span>
<span class="co">#&gt; 37: 2020-03-29 gp_rt   1302 10634  2822  6548 5618.0 6133.976 3216.79496</span>
<span class="co">#&gt; 38: 2020-03-30 gp_rt   1824 11113  3573  6901 5301.0 6030.932 3247.57796</span>
<span class="co">#&gt; 39: 2020-03-31 gp_rt   1185  8284  2815  5750 4813.5 5122.896 2435.69280</span>
<span class="co">#&gt; 40: 2020-04-01 gp_rt   1093  7339  2114  4408 3797.5 4226.644 2152.01092</span>
<span class="co">#&gt; 41: 2020-04-02 gp_rt   1307  8866  2482  5361 4540.0 4962.260 2585.04416</span>
<span class="co">#&gt; 42: 2020-04-03 gp_rt   1681 10833  2461  6030 5394.0 5926.578 3038.09044</span>
<span class="co">#&gt; 43: 2020-04-04 gp_rt    895  8175  3056  5857 4380.0 4790.108 2378.61451</span>
<span class="co">#&gt; 44: 2020-04-05 gp_rt   1023  8775  2559  5537 4597.0 5136.340 2794.30555</span>
<span class="co">#&gt; 45: 2020-04-06 gp_rt   1587  8493  1777  4428 4268.0 4857.798 2600.59912</span>
<span class="co">#&gt; 46: 2020-04-07 gp_rt   1023  7298  1742  4217 3668.0 4046.914 2143.49553</span>
<span class="co">#&gt; 47: 2020-04-08 gp_rt    703  5439  1656  3505 3005.5 3254.126 1764.74083</span>
<span class="co">#&gt; 48: 2020-04-09 gp_rt    832  6896  1780  4215 3491.5 3939.996 2226.82248</span>
<span class="co">#&gt; 49: 2020-04-10 gp_rt    564  8140  2065  4793 4016.0 4574.440 2668.13093</span>
<span class="co">#&gt; 50: 2020-04-11 gp_rt    774  6444  1485  3709 3292.5 3714.246 2140.26301</span>
<span class="co">#&gt; 51: 2020-04-12 gp_rt   1033  8003  1624  4166 3636.5 4252.412 2907.12434</span>
<span class="co">#&gt; 52: 2020-04-13 gp_rt    314  7614  1285  3641 3252.5 3945.210 2990.48684</span>
<span class="co">#&gt; 53: 2020-04-14 gp_rt    374  6874  1075  2992 2746.5 3550.534 3046.26356</span>
<span class="co">#&gt; 54: 2020-04-15 gp_rt    142  5239  1057  2669 2226.0 2855.966 2525.42336</span>
<span class="co">#&gt; 55: 2020-04-16 gp_rt    361  6498   653  2748 2574.5 3628.484 4226.87475</span>
<span class="co">#&gt; 56: 2020-04-17 gp_rt    458  9039  1045  3289 2876.0 4804.820 8242.91616</span>
<span class="co">#&gt; 57: 2020-04-18 gp_rt    204  7451   917  2695 2378.5 4145.540 8458.84071</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean         sd</span></pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>
<span class="co">#&gt;                                  measure              estimate numeric_estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date     2048 (19 -- 7867)     &lt;data.table&gt;</span>
<span class="co">#&gt; 2:        Expected change in daily cases                Unsure             0.72</span>
<span class="co">#&gt; 3:            Effective reproduction no.      0.8 (0.2 -- 1.4)     &lt;data.table&gt;</span>
<span class="co">#&gt; 4:                        Rate of growth -0.06 (-0.26 -- 0.11)     &lt;data.table&gt;</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)   -10.9 (6.4 -- -2.7)     &lt;data.table&gt;</span></pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">estimates</span>$<span class="no">plots</span>$<span class="no">summary</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-11-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="no">reported_cases</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="no">reported_cases</span>)[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"testland"</span>],
   <span class="no">reported_cases</span>[, <span class="no">region</span> <span class="kw">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span></pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="co">## future::plan("multisession")</span>
<span class="no">estimates</span> <span class="kw">&lt;-</span> <span class="kw pkg">EpiNow2</span><span class="kw ns">::</span><span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(<span class="kw">reported_cases</span> <span class="kw">=</span> <span class="no">reported_cases</span>,
                                      <span class="kw">generation_time</span> <span class="kw">=</span> <span class="no">generation_time</span>,
                                      <span class="kw">delays</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">incubation_period</span>, <span class="no">reporting_delay</span>),
                                      <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">samples</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">200</span>,
                                      <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">adapt_delta</span> <span class="kw">=</span> <span class="fl">0.95</span>,
                                      <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Stan model 'estimate_infections' does not contain samples.</span></pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summarised_results</span>$<span class="no">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                     2012 (26 -- 8451)</span>
<span class="co">#&gt; 2: testland                     2190 (13 -- 9426)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.8 (0.3 -- 1.5)</span>
<span class="co">#&gt; 2:                         Unsure           0.8 (0.2 -- 1.6)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1: -0.06 (-0.23 -- 0.13)            -11.3 (5.2 -- -3)</span>
<span class="co">#&gt; 2: -0.06 (-0.24 -- 0.16)          -12.3 (4.4 -- -2.9)</span></pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="no">estimates</span>$<span class="no">summary</span>$<span class="no">summary_plot</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-15-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://epiforecasts.io/covid/">limitations</a> as these are key to understanding our results.</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/247464257"><img src="https://zenodo.org/badge/247464257.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
